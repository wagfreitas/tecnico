!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(self.webpackChunkdriver=self.webpackChunkdriver||[]).push([[8695],{1538:function(n,i,o){"use strict";o.r(i),o.d(i,{PickupPageModule:function(){return w}});var r=o(8583),a=o(3679),c=o(2859),l=o(3025),u=o(5257),s=o(7716),p=o(7446),g=o(6999),d=o(5620),f=o(5469),h=o(7318),Z=o(7152);function m(t,n){if(1&t){var e=s.EpF();s.TgZ(0,"ion-buttons",9),s.TgZ(1,"ion-button",10),s.NdJ("click",function(){return s.CHM(e),s.oxw().cancelTrip()}),s._uU(2,"CANCELA "),s.qZA(),s.qZA()}}function v(t,n){if(1&t&&(s.TgZ(0,"ion-item"),s.TgZ(1,"ion-label"),s.TgZ(2,"ion-text"),s.TgZ(3,"h2"),s._uU(4),s.qZA(),s.qZA(),s.TgZ(5,"ion-text"),s.TgZ(6,"p"),s._uU(7),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"ion-button",11),s._UZ(9,"ion-icon",12),s._uU(10,"\xa0 CHAMAR "),s.qZA(),s.qZA()),2&t){var e=s.oxw();s.xp6(4),s.Oqu(null==e.passenger?null:e.passenger.name),s.xp6(3),s.AsE("",null==e.passenger?null:e.passenger.ddd,"",null==e.passenger?null:e.passenger.phoneNumber,""),s.xp6(1),s.MGl("href","tel:",e.passenger.phoneNumber,"")}}function A(t,n){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){var e=s.oxw();s.xp6(1),s.Oqu(e.trip.origin.vicinity)}}function b(t,n){if(1&t){var e=s.EpF();s.TgZ(0,"ion-item"),s.TgZ(1,"ion-label"),s.TgZ(2,"ion-text"),s.TgZ(3,"h2"),s._uU(4,"Valor R$:"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(5,"ion-input",13),s.NdJ("ngModelChange",function(t){return s.CHM(e),s.oxw().tax=t}),s.qZA(),s.TgZ(6,"ion-button",5),s.NdJ("click",function(){return s.CHM(e),s.oxw().valuePayment()}),s._uU(7," OK "),s.qZA(),s.qZA()}if(2&t){var i=s.oxw();s.xp6(5),s.Q6J("ngModel",i.tax)}}function k(t,n){if(1&t){var e=s.EpF();s.TgZ(0,"ion-button",14),s.NdJ("click",function(){return s.CHM(e),s.oxw().pickup()}),s._uU(1,"INICIAR ATENDIMENTO "),s.qZA()}}function T(t,n){if(1&t){var e=s.EpF();s.TgZ(0,"ion-button",14),s.NdJ("click",function(){return s.CHM(e),s.oxw().showPayment()}),s._uU(1," FINALIZAR O ATENDIMENTO"),s.qZA()}}var x,q,C=[{path:"",component:(x=function(){function n(e,i,o,r,a,c,l,u,s){t(this,n),this.tripService=e,this.alertCtrl=i,this.dealService=o,this.router=r,this.common=a,this.translate=c,this.db=l,this.menuCtrl=u,this.geolocation=s,this.trip={},this.passenger={},this.isTripStarted=!1,this.tax=0,this.total=!1,this.finaliza=!1,this.menuCtrl.enable(!0)}return e(n,[{key:"ngOnInit",value:function(){}},{key:"ionViewDidEnter",value:function(){var t=this;this.trip=this.tripService.getCurrentTrip();var n=this.tripService.getTripStatus(this.trip.key).valueChanges().subscribe(function(e){t.trip.status=e.status,"canceled"==e.status?(n.unsubscribe(),t.tripService.cancel(t.trip.key),t.dealService.removeDeal(t.trip.driverId),t.common.showAlert("Atendimento Cancelado"),t.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})):"finished"==e.status&&t.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})});this.tripService.getPassenger(this.trip.passengerId).valueChanges().pipe((0,u.q)(1)).subscribe(function(n){t.passenger=n})}},{key:"cancelTrip",value:function(){var t=this;this.alertCtrl.create({message:"Deseja cancelar o atendimento",buttons:[{text:"Sim",handler:function(){return t.tripService.cancel(t.trip.key)}},{text:"N\xe3o"}]}).then(function(t){return t.present()})}},{key:"pickup",value:function(){var t=this;this.alertCtrl.create({subHeader:"Entre com o C\xf3digo de Atendimento",inputs:[{name:"otp",placeholder:"4 digitos",type:"tel"}],buttons:[{text:"Verificar",handler:function(n){t.db.object("trips/"+t.trip.key).valueChanges().pipe((0,u.q)(1)).subscribe(function(e){e.otp!=n.otp?t.common.showAlert("C\xf3digo Inv\xe1lido"):(t.total=!0,t.isTripStarted=!0,t.tripService.pickUp(t.trip.key))})}}]}).then(function(t){return t.present()})}},{key:"getDirection",value:function(t,n){console.log(t,n),this.geolocation.getCurrentPosition().then(function(e){window.open("https://waze.com/ul?ll=".concat(t,",").concat(n,"&z=10"))}).catch(function(t){console.log("Error ")})}},{key:"valuePayment",value:function(){this.tripService.addValueToService(this.trip.key,this.tax),this.common.showAlert("Valor Atualizado com Sucesso"),this.finaliza=!0}},{key:"showPayment",value:function(){var t=this;this.alertCtrl.create({header:"Deseja completar o atendimento?",buttons:[{text:"Sim",handler:function(){t.tripService.dropOff(t.trip.key),t.dealService.removeDeal(t.trip.driverId),t.router.navigateByUrl("/home")}},{text:"N\xe3o"}]}).then(function(t){return t.present()})}}]),n}(),x.\u0275fac=function(t){return new(t||x)(s.Y36(p.a),s.Y36(c.Br),s.Y36(g.q),s.Y36(l.F0),s.Y36(d.v),s.Y36(f.sK),s.Y36(h.KQ),s.Y36(c._q),s.Y36(Z.b))},x.\u0275cmp=s.Xpm({type:x,selectors:[["app-pickup"]],decls:25,vars:6,consts:[["color","dark"],[1,"ion-text-center"],["slot","end",4,"ngIf"],["lines","none"],[4,"ngIf"],["slot","end","fill","outline","color","dark",3,"click"],["name","navigate"],[1,"ion-padding"],["expand","block","color","dark",3,"click",4,"ngIf"],["slot","end"],["color","danger","fill","solid",3,"click"],["color","dark","slot","end",3,"href"],["name","call"],["color","dark","slot","end",3,"ngModel","ngModelChange"],["expand","block","color","dark",3,"click"]],template:function(t,n){1&t&&(s.TgZ(0,"ion-header"),s.TgZ(1,"ion-toolbar",0),s.TgZ(2,"ion-title",1),s._uU(3," Dados do Atendimento "),s.qZA(),s.YNc(4,m,3,0,"ion-buttons",2),s.qZA(),s.qZA(),s.TgZ(5,"ion-content"),s.TgZ(6,"ion-card"),s.TgZ(7,"ion-card-content"),s.TgZ(8,"ion-list",3),s.YNc(9,v,11,4,"ion-item",4),s.TgZ(10,"ion-item"),s.TgZ(11,"ion-label"),s.TgZ(12,"ion-text"),s.TgZ(13,"h2"),s._uU(14,"LOCAL"),s.qZA(),s.qZA(),s.TgZ(15,"ion-text"),s.YNc(16,A,2,1,"p",4),s.qZA(),s.qZA(),s.TgZ(17,"ion-button",5),s.NdJ("click",function(){return n.getDirection(n.trip.origin.location.lat,n.trip.origin.location.lng)}),s._UZ(18,"ion-icon",6),s._uU(19,"\xa0 NAVEGAR "),s.qZA(),s.qZA(),s.YNc(20,b,8,1,"ion-item",4),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(21,"ion-footer",7),s.TgZ(22,"ion-toolbar"),s.YNc(23,k,2,0,"ion-button",8),s.YNc(24,T,2,0,"ion-button",8),s.qZA(),s.qZA()),2&t&&(s.xp6(4),s.Q6J("ngIf","waiting"==n.trip.status),s.xp6(5),s.Q6J("ngIf",n.passenger.phoneNumber),s.xp6(7),s.Q6J("ngIf",null!=n.trip.origin),s.xp6(4),s.Q6J("ngIf",n.total),s.xp6(3),s.Q6J("ngIf","waiting"==n.trip.status),s.xp6(1),s.Q6J("ngIf","going"==n.trip.status))},directives:[c.Gu,c.sr,c.wd,r.O5,c.W2,c.PM,c.FN,c.q_,c.Ie,c.Q$,c.yW,c.YG,c.gu,c.fr,c.Sm,c.pK,c.j9,a.JJ,a.On],styles:["h3[_ngcontent-%COMP%]{text-align:center;padding:8px;color:#4caf50;font-size:2rem}table[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]{border:1px solid #eee}td[_ngcontent-%COMP%]{padding:4px}.footer-md[_ngcontent-%COMP%]:before{background-image:none!important}.payment-mode[_ngcontent-%COMP%]{background:#f2f2f2;padding:2px}"]}),x)}],y=function(){var n=e(function n(){t(this,n)});return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=s.oAB({type:n}),n.\u0275inj=s.cJS({imports:[[l.Bz.forChild(C)],l.Bz]}),n}(),w=((q=e(function n(){t(this,n)})).\u0275fac=function(t){return new(t||q)},q.\u0275mod=s.oAB({type:q}),q.\u0275inj=s.cJS({imports:[[r.ez,a.u5,c.Pc,f.aw,y]]}),q)}}])}();