(self.webpackChunkdriver=self.webpackChunkdriver||[]).push([[9857],{9857:function(t,n,e){"use strict";e.r(n),e.d(n,{HistoryPageModule:function(){return d}});var i=e(8583),o=e(3679),r=e(2859),s=e(3025),a=e(7716),l=e(7446),c=e(5469),g=e(4207),u=e(7556);function p(t,n){1&t&&(a.TgZ(0,"p",16),a._uU(1,"Nenhum Atendimento at\xe9 o momento"),a.qZA())}function h(t,n){if(1&t&&(a.TgZ(0,"ion-item",17),a.TgZ(1,"ion-label"),a.TgZ(2,"h3"),a._uU(3),a.ALo(4,"date"),a.qZA(),a.TgZ(5,"p"),a._uU(6),a.qZA(),a.TgZ(7,"p",18),a._UZ(8,"ion-icon",19),a._uU(9),a.qZA(),a.TgZ(10,"p",18),a._UZ(11,"ion-icon",20),a._uU(12),a.qZA(),a.qZA(),a.TgZ(13,"ion-text",21),a._uU(14),a.qZA(),a.qZA()),2&t){const t=n.$implicit;a.xp6(3),a.Oqu(a.xi3(4,7,t.createdAt,"dd MMM , yyyy hh:mm a")),a.xp6(3),a.AsE("",t.createdAt," \u2022 ",t.status,""),a.xp6(3),a.hij(" ",t.origin.vicinity," "),a.xp6(3),a.hij(" ",t.destination.vicinity," "),a.xp6(2),a.AsE("",t.currency," ",t.commission," ")}}const Z=[{path:"",component:(()=>{class t{constructor(t,n,e,i,o){this.tripService=t,this.translate=n,this.ss=e,this.authService=i,this.router=o,this.trips=[],this.earning=0,this.filter="today",this.allTrips=[],this.settings={},this.today=(new Date).toISOString(),this.fromDate=(new Date).toISOString(),this.toDate=(new Date).toISOString(),this.ss.getSettings().subscribe(t=>this.settings=null!=t?t.payload.val():{})}ngOnInit(){this.authService.getUserData().then(t=>{this.tripService.getTrips(t.uid).valueChanges().subscribe(t=>{null!=t&&(this.trips=t,this.allTrips=this.trips,this.allTrips.reverse(),this.calculateEarning())})})}logout(){this.authService.logout().then(()=>{localStorage.clear(),this.router.navigateByUrl("/login",{skipLocationChange:!0,replaceUrl:!0})})}calculateEarning(){let t=0;this.trips.forEach(n=>{null!=n.commission&&null!=n.commission&&(t+=parseFloat(n.commission))}),this.earning=t}applyFilter(){this.trips=this.allTrips;let t=new Date(this.fromDate);t.setHours(0,0,0,0);let n=t.getTime(),e=new Date(this.toDate);e.setHours(23,59,59,999);let i=e.getTime(),o=this.trips.filter(t=>t.createdAt>=n&&t.createdAt<=i);this.trips=o,this.calculateEarning()}reset(){this.trips=this.allTrips,this.calculateEarning()}}return t.\u0275fac=function(n){return new(n||t)(a.Y36(l.a),a.Y36(c.sK),a.Y36(g.R),a.Y36(u.e),a.Y36(s.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-history"]],decls:30,vars:14,consts:[["color","dark"],["slot","start"],[1,"ion-text-center"],["slot","end"],[3,"click"],["name","log-out"],[2,"padding","4px","background","#fbfbfb"],[3,"max","value","ngModel","ngModelChange"],[3,"max","min","value","ngModel","ngModelChange"],["size","small","fill","clear",3,"click"],["name","filter-outline"],["name","refresh-outline"],["lines","none"],["slot","end",1,"total-earning"],["style","margin-top: 5px; text-align: center",4,"ngIf"],["class","trip",4,"ngFor","ngForOf"],[2,"margin-top","5px","text-align","center"],[1,"trip"],["text-wrap",""],["name","pin",2,"color","#F44336"],["name","pin",2,"color","#4caf50"],["slot","end",1,"earning"]],template:function(t,n){1&t&&(a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar",0),a.TgZ(2,"ion-buttons",1),a._UZ(3,"ion-menu-button"),a.qZA(),a.TgZ(4,"ion-title",2),a._uU(5,"Atendimentos"),a.qZA(),a.TgZ(6,"ion-buttons",3),a.TgZ(7,"ion-button",4),a.NdJ("click",function(){return n.logout()}),a._UZ(8,"ion-icon",5),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(9,"ion-content"),a.TgZ(10,"div",6),a.TgZ(11,"ion-row"),a.TgZ(12,"ion-col"),a.TgZ(13,"ion-datetime",7),a.NdJ("ngModelChange",function(t){return n.fromDate=t}),a.qZA(),a.qZA(),a.TgZ(14,"ion-col"),a.TgZ(15,"ion-datetime",8),a.NdJ("ngModelChange",function(t){return n.toDate=t}),a.qZA(),a.qZA(),a.TgZ(16,"ion-col"),a.TgZ(17,"ion-button",9),a.NdJ("click",function(){return n.applyFilter()}),a._UZ(18,"ion-icon",10),a.qZA(),a.TgZ(19,"ion-button",9),a.NdJ("click",function(){return n.reset()}),a._UZ(20,"ion-icon",11),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(21,"ion-list",12),a.TgZ(22,"ion-item"),a.TgZ(23,"ion-label"),a._uU(24,"Faturamento"),a.qZA(),a.TgZ(25,"ion-text",13),a._uU(26),a.ALo(27,"number"),a.qZA(),a.qZA(),a.YNc(28,p,2,0,"p",14),a.YNc(29,h,15,10,"ion-item",15),a.qZA(),a.qZA()),2&t&&(a.xp6(13),a.s9C("max",n.today),a.s9C("value",n.today),a.Q6J("ngModel",n.fromDate),a.xp6(2),a.s9C("max",n.today),a.s9C("min",n.fromDate),a.s9C("value",n.today),a.Q6J("ngModel",n.toDate),a.xp6(11),a.AsE(" ",n.settings.currency," ",a.xi3(27,11,n.earning,"1.2-2")," "),a.xp6(2),a.Q6J("ngIf",0==n.trips.length),a.xp6(1),a.Q6J("ngForOf",n.trips))},directives:[r.Gu,r.sr,r.Sm,r.fG,r.wd,r.YG,r.gu,r.W2,r.Nd,r.wI,r.x4,r.QI,o.JJ,o.On,r.q_,r.Ie,r.Q$,r.yW,i.O5,i.sg],pipes:[i.JJ,i.uU],styles:[".total-earning[_ngcontent-%COMP%]{font-size:18px}.earning[_ngcontent-%COMP%], .total-earning[_ngcontent-%COMP%]{color:#4caf50;font-weight:600}.earning[_ngcontent-%COMP%]{margin-left:4px}p[_ngcontent-%COMP%]{color:#777}ion-item[_ngcontent-%COMP%]{margin:8px;--background:#fbfbfb;border-radius:4px}.trip[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;font-size:14px}"]}),t})()}];let m=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[s.Bz.forChild(Z)],s.Bz]}),t})(),d=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[i.ez,o.u5,r.Pc,c.aw,m]]}),t})()}}]);