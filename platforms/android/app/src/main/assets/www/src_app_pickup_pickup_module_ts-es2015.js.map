{"version":3,"sources":["./src/app/pickup/pickup-routing.module.ts","./src/app/pickup/pickup.module.ts","./src/app/pickup/pickup.page.ts","./src/app/pickup/pickup.page.scss","./src/app/pickup/pickup.page.html"],"names":[],"mappings":"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","file":"src_app_pickup_pickup_module_ts-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { PickupPage } from './pickup.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PickupPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class PickupPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { PickupPageRoutingModule } from './pickup-routing.module';\n\nimport { PickupPage } from './pickup.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    PickupPageRoutingModule\n  ],\n  declarations: [PickupPage]\n})\nexport class PickupPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { TripService } from '../services/trip.service';\nimport { Router } from '@angular/router';\nimport { DealService } from '../services/deal.service';\nimport { Observable } from 'rxjs';\nimport { take } from 'rxjs/operators'\nimport { AlertController, MenuController } from '@ionic/angular';\nimport { CommonService } from '../services/common.service';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\n\n\n\n@Component({\n  selector: 'app-pickup',\n  templateUrl: './pickup.page.html',\n  styleUrls: ['./pickup.page.scss'],\n})\nexport class PickupPage implements OnInit {\n\n\n  trip: any = {};\n  passenger: any = {};\n  isTripStarted = false;\n  discount;\n  tax = 0 ;\n  total = false; \n  finaliza=false\n\n  constructor(\n    private tripService: TripService,\n    private alertCtrl: AlertController,\n    private dealService: DealService,\n    private router: Router,\n    private common: CommonService,\n    private translate: TranslateService,\n    private db: AngularFireDatabase,\n    private menuCtrl: MenuController,\n    private geolocation: Geolocation\n  ) {\n    this.menuCtrl.enable(true);\n  }\n\n  ngOnInit() { }\n\n  ionViewDidEnter() {\n    this.trip = this.tripService.getCurrentTrip();\n   //this.discount = (this.trip.rawfee * (this.trip.discount / 100)).toFixed(2)\n    let getTrips = this.tripService.getTripStatus(this.trip.key).valueChanges().subscribe((trip: any) => {\n      this.trip.status = trip.status;\n      if (trip.status == 'canceled') {\n        getTrips.unsubscribe();\n        this.tripService.cancel(this.trip.key);\n        this.dealService.removeDeal(this.trip.driverId);\n        this.common.showAlert(\"Atendimento Cancelado\");\n        this.router.navigateByUrl('/home', { skipLocationChange: true, replaceUrl: true });\n      }\n      else if (trip.status == 'finished') {\n        this.router.navigateByUrl('/home', { skipLocationChange: true, replaceUrl: true });\n      }\n    })\n    this.tripService.getPassenger(this.trip.passengerId).valueChanges().pipe(take(1)).subscribe(snapshot => {\n      this.passenger = snapshot;\n    })\n  }\n\n\n  cancelTrip() {\n    this.alertCtrl.create({\n      message: \"Deseja cancelar o atendimento\",\n      buttons: [{\n        text: \"Sim\",\n        handler: () => this.tripService.cancel(this.trip.key)\n      }, {\n        text: \"Não\"\n      }]\n    }).then(res => res.present());\n  }\n\n  // pickup\n  pickup() {\n    this.alertCtrl.create({\n      subHeader: \"Entre com o Código de Atendimento\",\n      inputs: [{\n        name: 'otp',\n        placeholder: '4 digitos',\n        type: 'tel',\n      }],\n      buttons: [{\n        text: \"Verificar\",\n        handler: (data) => {\n          this.db.object('trips/' + this.trip.key).valueChanges().pipe(take(1)).subscribe((res: any) => {\n            if (res.otp != data.otp) this.common.showAlert(\"Código Inválido\");\n            else {\n              this.total = true;\n              this.isTripStarted = true;\n              this.tripService.pickUp(this.trip.key);\n            }\n          })\n        }\n      }]\n    }).then(res => res.present());\n  }\n\n  getDirection(lat, lng) {\n    console.log(lat,lng)\n    this.geolocation.getCurrentPosition().then(geo => {\n      geo.coords.latitude\n     \n      let url = `https://waze.com/ul?ll=${lat},${lng}&z=10`\n\n      // `https://waze.com/ul?ll=${geo.coords.latitude},${geo.coords.longitude}&z=10`\n      //\"https://www.google.com/maps/dir/?api=1&travelmode=driving&origin=\" + geo.coords.latitude + \",\" + geo.coords.longitude + \"&destination=\" + lat + \",\" + lng;\n      window.open(url);\n    }).catch(err => {\n      console.log(\"Error \");\n    })\n  }\n\n  valuePayment(){\n    this.tripService.addValueToService(this.trip.key, this.tax)\n    this.common.showAlert(\"Valor Atualizado com Sucesso\");\n    this.finaliza = true\n\n  }\n\n\n  showPayment() {\n    this.alertCtrl.create({\n      header: \"Deseja completar o atendimento?\",\n      buttons: [\n        {\n          text: 'Sim',\n          handler: () => {\n            this.tripService.dropOff(this.trip.key);\n            this.dealService.removeDeal(this.trip.driverId);\n            this.router.navigateByUrl('/home');\n          }\n        },\n        {\n          text: \"Não\"\n        }\n      ]\n    }).then(res => res.present());\n  }\n}\n","export default \"h3 {\\n  text-align: center;\\n  padding: 8px;\\n  color: #4CAF50;\\n  font-size: 2rem;\\n}\\n\\ntable {\\n  width: 100%;\\n}\\n\\ntr {\\n  border: 1px solid #eee;\\n}\\n\\ntd {\\n  padding: 4px;\\n}\\n\\n.footer-md:before {\\n  background-image: none !important;\\n}\\n\\n.payment-mode {\\n  background: #f2f2f2;\\n  padding: 2px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBpY2t1cC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxrQkFBQTtFQUNBLFlBQUE7RUFDQSxjQUFBO0VBQ0EsZUFBQTtBQUNKOztBQUVBO0VBQ0ksV0FBQTtBQUNKOztBQUVBO0VBQ0ksc0JBQUE7QUFDSjs7QUFFQTtFQUNJLFlBQUE7QUFDSjs7QUFFQTtFQUNJLGlDQUFBO0FBQ0o7O0FBRUE7RUFDSSxtQkFBQTtFQUNBLFlBQUE7QUFDSiIsImZpbGUiOiJwaWNrdXAucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaDN7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHBhZGRpbmc6IDhweDtcbiAgICBjb2xvcjogIzRDQUY1MDtcbiAgICBmb250LXNpemU6IDJyZW07XG59XG5cbnRhYmxle1xuICAgIHdpZHRoOiAxMDAlO1xufVxuXG50cntcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWVlO1xufVxuXG50ZHtcbiAgICBwYWRkaW5nOiA0cHg7XG59XG5cbi5mb290ZXItbWQ6YmVmb3Jle1xuICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmUgIWltcG9ydGFudDtcbn1cblxuLnBheW1lbnQtbW9kZXtcbiAgICBiYWNrZ3JvdW5kOiAjZjJmMmYyO1xuICAgIHBhZGRpbmc6MnB4O1xufSJdfQ== */\";","export default \"<ion-header>\\n  <ion-toolbar color=\\\"dark\\\">\\n    <ion-title class=\\\"ion-text-center\\\"> Dados do Atendimento </ion-title>\\n    <ion-buttons slot=\\\"end\\\" *ngIf=\\\"trip.status == 'waiting'\\\">\\n      <ion-button color=\\\"danger\\\" fill=\\\"solid\\\" (click)=\\\"cancelTrip()\\\">CANCELA\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card>\\n    <ion-card-content>\\n      <ion-list lines=\\\"none\\\">\\n        <ion-item *ngIf=\\\"passenger.phoneNumber\\\">\\n          <ion-label>\\n            <ion-text>\\n              <h2>{{(passenger)?.name }}</h2>\\n            </ion-text>\\n            <ion-text>\\n              <p>{{(passenger)?.ddd }}{{(passenger)?.phoneNumber }}</p>\\n            </ion-text>\\n          </ion-label>\\n          <ion-button color=\\\"dark\\\"  slot=\\\"end\\\" href=\\\"tel:{{passenger.phoneNumber}}\\\">\\n            <ion-icon  name=\\\"call\\\"></ion-icon>&nbsp; CHAMAR\\n          </ion-button>\\n        </ion-item>\\n       \\n        <ion-item>\\n          <ion-label>\\n            <ion-text>\\n              <h2>LOCAL</h2>\\n            </ion-text>\\n            <ion-text>\\n              <p *ngIf=\\\"trip.origin != undefined\\\">{{ trip.origin.vicinity }}</p>\\n            </ion-text>\\n          </ion-label>\\n          <ion-button slot=\\\"end\\\" fill=\\\"outline\\\" color=\\\"dark\\\"\\n            (click)=\\\"getDirection(trip.origin.location.lat,trip.origin.location.lng)\\\">\\n            <ion-icon name=\\\"navigate\\\"></ion-icon>&nbsp; NAVEGAR\\n          </ion-button>\\n        </ion-item>\\n\\n        <ion-item *ngIf=\\\"total\\\" >\\n          <ion-label> \\n            <ion-text>\\n            <h2>Valor R$:</h2>\\n          </ion-text>   \\n        </ion-label>\\n          <ion-input color=\\\"dark\\\" [(ngModel)]=\\\"tax\\\" slot=\\\"end\\\"></ion-input>\\n          <ion-button slot=\\\"end\\\" fill=\\\"outline\\\" color=\\\"dark\\\"\\n            (click)=\\\"valuePayment()\\\">\\n          OK\\n          </ion-button>\\n        </ion-item>\\n\\n      </ion-list>\\n    </ion-card-content>\\n  </ion-card>\\n\\n</ion-content>\\n<ion-footer class=\\\"ion-padding\\\">\\n  <ion-toolbar>\\n    <ion-button *ngIf=\\\"trip.status == 'waiting'\\\" expand=\\\"block\\\" color=\\\"dark\\\" (click)=\\\"pickup()\\\">INICIAR ATENDIMENTO\\n    </ion-button>\\n    <ion-button *ngIf=\\\"trip.status == 'going'\\\" expand=\\\"block\\\" color=\\\"dark\\\" (click)=\\\"showPayment()\\\">\\n     FINALIZAR O ATENDIMENTO</ion-button>\\n  </ion-toolbar>\\n</ion-footer>\";"],"sourceRoot":"webpack:///"}