(self.webpackChunkdriver=self.webpackChunkdriver||[]).push([[8695],{1538:function(t,e,n){"use strict";n.r(e),n.d(e,{PickupPageModule:function(){return k}});var i=n(8583),o=n(3679),r=n(2859),s=n(3025),a=n(5257),c=n(7716),l=n(7446),p=n(6999),u=n(5620),g=n(5469),h=n(7318),d=n(7152);function Z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-buttons",9),c.TgZ(1,"ion-button",10),c.NdJ("click",function(){return c.CHM(t),c.oxw().cancelTrip()}),c._uU(2,"CANCELA "),c.qZA(),c.qZA()}}function f(t,e){if(1&t&&(c.TgZ(0,"ion-item"),c.TgZ(1,"ion-label"),c.TgZ(2,"ion-text"),c.TgZ(3,"h2"),c._uU(4),c.qZA(),c.qZA(),c.TgZ(5,"ion-text"),c.TgZ(6,"p"),c._uU(7),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-button",11),c._UZ(9,"ion-icon",12),c._uU(10,"\xa0 CHAMAR "),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(4),c.Oqu(null==t.passenger?null:t.passenger.name),c.xp6(3),c.AsE("",null==t.passenger?null:t.passenger.ddd,"",null==t.passenger?null:t.passenger.phoneNumber,""),c.xp6(1),c.MGl("href","tel:",t.passenger.phoneNumber,"")}}function m(t,e){if(1&t&&(c.TgZ(0,"p"),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.trip.origin.vicinity)}}function A(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item"),c.TgZ(1,"ion-label"),c.TgZ(2,"ion-text"),c.TgZ(3,"h2"),c._uU(4,"Valor R$:"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(5,"ion-input",13),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().tax=e}),c.qZA(),c.TgZ(6,"ion-button",5),c.NdJ("click",function(){return c.CHM(t),c.oxw().valuePayment()}),c._uU(7," OK "),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(5),c.Q6J("ngModel",t.tax)}}function b(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",14),c.NdJ("click",function(){return c.CHM(t),c.oxw().pickup()}),c._uU(1,"INICIAR ATENDIMENTO "),c.qZA()}}function T(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",14),c.NdJ("click",function(){return c.CHM(t),c.oxw().showPayment()}),c._uU(1," FINALIZAR O ATENDIMENTO"),c.qZA()}}const x=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,r,s,a,c){this.tripService=t,this.alertCtrl=e,this.dealService=n,this.router=i,this.common=o,this.translate=r,this.db=s,this.menuCtrl=a,this.geolocation=c,this.trip={},this.passenger={},this.isTripStarted=!1,this.tax=0,this.total=!1,this.finaliza=!1,this.menuCtrl.enable(!0)}ngOnInit(){}ionViewDidEnter(){this.trip=this.tripService.getCurrentTrip();let t=this.tripService.getTripStatus(this.trip.key).valueChanges().subscribe(e=>{this.trip.status=e.status,"canceled"==e.status?(t.unsubscribe(),this.tripService.cancel(this.trip.key),this.dealService.removeDeal(this.trip.driverId),this.common.showAlert("Atendimento Cancelado"),this.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})):"finished"==e.status&&this.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})});this.tripService.getPassenger(this.trip.passengerId).valueChanges().pipe((0,a.q)(1)).subscribe(t=>{this.passenger=t})}cancelTrip(){this.alertCtrl.create({message:"Deseja cancelar o atendimento",buttons:[{text:"Sim",handler:()=>this.tripService.cancel(this.trip.key)},{text:"N\xe3o"}]}).then(t=>t.present())}pickup(){this.alertCtrl.create({subHeader:"Entre com o C\xf3digo de Atendimento",inputs:[{name:"otp",placeholder:"4 digitos",type:"tel"}],buttons:[{text:"Verificar",handler:t=>{this.db.object("trips/"+this.trip.key).valueChanges().pipe((0,a.q)(1)).subscribe(e=>{e.otp!=t.otp?this.common.showAlert("C\xf3digo Inv\xe1lido"):(this.total=!0,this.isTripStarted=!0,this.tripService.pickUp(this.trip.key))})}}]}).then(t=>t.present())}getDirection(t,e){console.log(t,e),this.geolocation.getCurrentPosition().then(n=>{window.open(`https://waze.com/ul?ll=${t},${e}&z=10`)}).catch(t=>{console.log("Error ")})}valuePayment(){this.tripService.addValueToService(this.trip.key,this.tax),this.common.showAlert("Valor Atualizado com Sucesso"),this.finaliza=!0}showPayment(){this.alertCtrl.create({header:"Deseja completar o atendimento?",buttons:[{text:"Sim",handler:()=>{this.tripService.dropOff(this.trip.key),this.dealService.removeDeal(this.trip.driverId),this.router.navigateByUrl("/home")}},{text:"N\xe3o"}]}).then(t=>t.present())}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(l.a),c.Y36(r.Br),c.Y36(p.q),c.Y36(s.F0),c.Y36(u.v),c.Y36(g.sK),c.Y36(h.KQ),c.Y36(r._q),c.Y36(d.b))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-pickup"]],decls:25,vars:6,consts:[["color","dark"],[1,"ion-text-center"],["slot","end",4,"ngIf"],["lines","none"],[4,"ngIf"],["slot","end","fill","outline","color","dark",3,"click"],["name","navigate"],[1,"ion-padding"],["expand","block","color","dark",3,"click",4,"ngIf"],["slot","end"],["color","danger","fill","solid",3,"click"],["color","dark","slot","end",3,"href"],["name","call"],["color","dark","slot","end",3,"ngModel","ngModelChange"],["expand","block","color","dark",3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar",0),c.TgZ(2,"ion-title",1),c._uU(3," Dados do Atendimento "),c.qZA(),c.YNc(4,Z,3,0,"ion-buttons",2),c.qZA(),c.qZA(),c.TgZ(5,"ion-content"),c.TgZ(6,"ion-card"),c.TgZ(7,"ion-card-content"),c.TgZ(8,"ion-list",3),c.YNc(9,f,11,4,"ion-item",4),c.TgZ(10,"ion-item"),c.TgZ(11,"ion-label"),c.TgZ(12,"ion-text"),c.TgZ(13,"h2"),c._uU(14,"LOCAL"),c.qZA(),c.qZA(),c.TgZ(15,"ion-text"),c.YNc(16,m,2,1,"p",4),c.qZA(),c.qZA(),c.TgZ(17,"ion-button",5),c.NdJ("click",function(){return e.getDirection(e.trip.origin.location.lat,e.trip.origin.location.lng)}),c._UZ(18,"ion-icon",6),c._uU(19,"\xa0 NAVEGAR "),c.qZA(),c.qZA(),c.YNc(20,A,8,1,"ion-item",4),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(21,"ion-footer",7),c.TgZ(22,"ion-toolbar"),c.YNc(23,b,2,0,"ion-button",8),c.YNc(24,T,2,0,"ion-button",8),c.qZA(),c.qZA()),2&t&&(c.xp6(4),c.Q6J("ngIf","waiting"==e.trip.status),c.xp6(5),c.Q6J("ngIf",e.passenger.phoneNumber),c.xp6(7),c.Q6J("ngIf",null!=e.trip.origin),c.xp6(4),c.Q6J("ngIf",e.total),c.xp6(3),c.Q6J("ngIf","waiting"==e.trip.status),c.xp6(1),c.Q6J("ngIf","going"==e.trip.status))},directives:[r.Gu,r.sr,r.wd,i.O5,r.W2,r.PM,r.FN,r.q_,r.Ie,r.Q$,r.yW,r.YG,r.gu,r.fr,r.Sm,r.pK,r.j9,o.JJ,o.On],styles:["h3[_ngcontent-%COMP%]{text-align:center;padding:8px;color:#4caf50;font-size:2rem}table[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]{border:1px solid #eee}td[_ngcontent-%COMP%]{padding:4px}.footer-md[_ngcontent-%COMP%]:before{background-image:none!important}.payment-mode[_ngcontent-%COMP%]{background:#f2f2f2;padding:2px}"]}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[s.Bz.forChild(x)],s.Bz]}),t})(),k=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.ez,o.u5,r.Pc,g.aw,q]]}),t})()}}]);