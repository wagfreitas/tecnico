!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(self.webpackChunkdriver=self.webpackChunkdriver||[]).push([[8695],{1538:function(e,i,o){"use strict";o.r(i),o.d(i,{PickupPageModule:function(){return C}});var r=o(8583),c=o(3679),a=o(2859),s=o(3025),u=o(5257),l=o(7716),p=o(7446),g=o(6999),d=o(5620),f=o(5469),h=o(7318),Z=o(7152);function m(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"ion-buttons",11),l.TgZ(1,"ion-button",12),l.NdJ("click",function(){return l.CHM(n),l.oxw().cancelTrip()}),l._uU(2,"CANCELA "),l.qZA(),l.qZA()}}function v(t,e){if(1&t&&(l.TgZ(0,"ion-item"),l.TgZ(1,"ion-label"),l.TgZ(2,"ion-text"),l.TgZ(3,"h2"),l._uU(4),l.qZA(),l.qZA(),l.TgZ(5,"ion-text"),l.TgZ(6,"p"),l._uU(7),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"ion-button",13),l._UZ(9,"ion-icon",14),l._uU(10,"\xa0 FONE "),l.qZA(),l.qZA()),2&t){var n=l.oxw();l.xp6(4),l.Oqu(null==n.passenger?null:n.passenger.name),l.xp6(3),l.Oqu(null==n.passenger?null:n.passenger.phoneNumber),l.xp6(1),l.MGl("href","tel:",n.passenger.phoneNumber,"")}}function b(t,e){if(1&t&&(l.TgZ(0,"p"),l._uU(1),l.qZA()),2&t){var n=l.oxw();l.xp6(1),l.Oqu(n.trip.origin.vicinity)}}function A(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"ion-button",15),l.NdJ("click",function(){return l.CHM(n),l.oxw().pickup()}),l._uU(1,"INICIAR ATENDIMENTO "),l.qZA()}}function T(t,e){if(1&t){var n=l.EpF();l.TgZ(0,"ion-button",16),l.NdJ("click",function(){return l.CHM(n),l.oxw().showPayment()}),l._uU(1," COMPLETAR ATENDIMENTO"),l.qZA()}}var k,q,x=[{path:"",component:(k=function(){function e(n,i,o,r,c,a,s,u,l){t(this,e),this.tripService=n,this.alertCtrl=i,this.dealService=o,this.router=r,this.common=c,this.translate=a,this.db=s,this.menuCtrl=u,this.geolocation=l,this.trip={},this.passenger={},this.isTripStarted=!1,this.menuCtrl.enable(!0)}return n(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewDidEnter",value:function(){var t=this;this.trip=this.tripService.getCurrentTrip(),this.discount=(this.trip.rawfee*(this.trip.discount/100)).toFixed(2),this.tax=(this.trip.fee*(this.trip.tax/100)).toFixed(2);var e=this.tripService.getTripStatus(this.trip.key).valueChanges().subscribe(function(n){console.log(n),t.trip.status=n.status,"canceled"==n.status?(e.unsubscribe(),t.tripService.cancel(t.trip.key),t.dealService.removeDeal(t.trip.driverId),t.common.showAlert("Atendimento Cancelado"),t.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})):"finished"==n.status&&t.router.navigateByUrl("/home",{skipLocationChange:!0,replaceUrl:!0})});this.tripService.getPassenger(this.trip.passengerId).valueChanges().pipe((0,u.q)(1)).subscribe(function(e){t.passenger=e})}},{key:"cancelTrip",value:function(){var t=this;this.alertCtrl.create({message:"Deseja cancelar o atendimento",buttons:[{text:"Sim",handler:function(){return t.tripService.cancel(t.trip.key)}},{text:"N\xe3o"}]}).then(function(t){return t.present()})}},{key:"pickup",value:function(){var t=this;this.alertCtrl.create({subHeader:"Entre com o C\xf3digo de Atendimento",inputs:[{name:"otp",placeholder:"4 digitos",type:"tel"}],buttons:[{text:"Verificar",handler:function(e){console.log(e),t.db.object("trips/"+t.trip.key).valueChanges().pipe((0,u.q)(1)).subscribe(function(n){console.log(n),n.otp!=e.otp?t.common.showAlert("C\xf3digo Inv\xe1lido"):(t.isTripStarted=!0,t.tripService.pickUp(t.trip.key))})}}]}).then(function(t){return t.present()})}},{key:"getDirection",value:function(t,e){console.log("call"),this.geolocation.getCurrentPosition().then(function(n){window.open("https://www.google.com/maps/dir/?api=1&travelmode=driving&origin="+n.coords.latitude+","+n.coords.longitude+"&destination="+t+","+e)}).catch(function(t){console.log("Error ")})}},{key:"showPayment",value:function(){var t=this;this.alertCtrl.create({header:"Deseja completar o atendimento?",buttons:[{text:"Sim",handler:function(){t.tripService.dropOff(t.trip.key),t.dealService.removeDeal(t.trip.driverId),t.router.navigateByUrl("/home")}},{text:"N\xe3o"}]}).then(function(t){return t.present()})}}]),e}(),k.\u0275fac=function(t){return new(t||k)(l.Y36(p.a),l.Y36(a.Br),l.Y36(g.q),l.Y36(s.F0),l.Y36(d.v),l.Y36(f.sK),l.Y36(h.KQ),l.Y36(a._q),l.Y36(Z.b))},k.\u0275cmp=l.Xpm({type:k,selectors:[["app-pickup"]],decls:33,vars:8,consts:[["color","dark"],[1,"ion-text-center"],["slot","end",4,"ngIf"],["lines","none"],[4,"ngIf"],["slot","end","fill","outline","color","dark",3,"click"],["name","navigate"],[1,"ion-padding"],[1,"payment-mode"],["expand","block","color","dark",3,"click",4,"ngIf"],["expand","block","color","danger",3,"click",4,"ngIf"],["slot","end"],["color","danger","fill","solid",3,"click"],["slot","end",3,"href"],["name","call"],["expand","block","color","dark",3,"click"],["expand","block","color","danger",3,"click"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-title",1),l._uU(3," Dados do Atendimento "),l.qZA(),l.YNc(4,m,3,0,"ion-buttons",2),l.qZA(),l.qZA(),l.TgZ(5,"ion-content"),l.TgZ(6,"ion-card"),l.TgZ(7,"ion-card-content"),l.TgZ(8,"ion-list",3),l.YNc(9,v,11,3,"ion-item",4),l.TgZ(10,"ion-item"),l.TgZ(11,"ion-label"),l.TgZ(12,"ion-text"),l.TgZ(13,"h2"),l._uU(14,"LOCAL"),l.qZA(),l.qZA(),l.TgZ(15,"ion-text"),l.YNc(16,b,2,1,"p",4),l.qZA(),l.qZA(),l.TgZ(17,"ion-button",5),l.NdJ("click",function(){return e.getDirection(e.trip.origin.location.lat,e.trip.origin.location.lng)}),l._UZ(18,"ion-icon",6),l._uU(19,"\xa0 NAVEGAR "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(20,"div",7),l.TgZ(21,"table"),l.TgZ(22,"tr"),l.TgZ(23,"td"),l._uU(24,"TOTAL: "),l.qZA(),l.TgZ(25,"td"),l._uU(26),l.TgZ(27,"span",8),l._uU(28),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(29,"ion-footer",7),l.TgZ(30,"ion-toolbar"),l.YNc(31,A,2,0,"ion-button",9),l.YNc(32,T,2,0,"ion-button",10),l.qZA(),l.qZA()),2&t&&(l.xp6(4),l.Q6J("ngIf","waiting"==e.trip.status),l.xp6(5),l.Q6J("ngIf",e.passenger.phoneNumber),l.xp6(7),l.Q6J("ngIf",null!=e.trip.origin),l.xp6(10),l.AsE("",e.trip.currency," ",e.trip.fee," "),l.xp6(2),l.Oqu(e.trip.paymentMethod),l.xp6(3),l.Q6J("ngIf","waiting"==e.trip.status),l.xp6(1),l.Q6J("ngIf","going"==e.trip.status))},directives:[a.Gu,a.sr,a.wd,r.O5,a.W2,a.PM,a.FN,a.q_,a.Ie,a.Q$,a.yW,a.YG,a.gu,a.fr,a.Sm],styles:["h3[_ngcontent-%COMP%]{text-align:center;padding:8px;color:#4caf50;font-size:2rem}table[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]{border:1px solid #eee}td[_ngcontent-%COMP%]{padding:4px}.footer-md[_ngcontent-%COMP%]:before{background-image:none!important}.payment-mode[_ngcontent-%COMP%]{background:#f2f2f2;padding:2px}"]}),k)}],y=function(){var e=n(function e(){t(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[s.Bz.forChild(x)],s.Bz]}),e}(),C=((q=n(function e(){t(this,e)})).\u0275fac=function(t){return new(t||q)},q.\u0275mod=l.oAB({type:q}),q.\u0275inj=l.cJS({imports:[[r.ez,c.u5,a.Pc,f.aw,y]]}),q)}}])}();