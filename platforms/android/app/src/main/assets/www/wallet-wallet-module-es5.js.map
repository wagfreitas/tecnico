{"version":3,"sources":["webpack:///src/app/wallet/wallet.page.html","webpack:///src/app/services/transaction.service.ts","webpack:///src/app/wallet/wallet-routing.module.ts","webpack:///src/app/wallet/wallet.module.ts","webpack:///src/app/wallet/wallet.page.scss","webpack:///src/app/wallet/wallet.page.ts"],"names":["TransactionService","db","uid","list","ref","orderByChild","equalTo","user","amount","push","userId","name","createdAt","Date","now","type","status","providedIn","routes","path","component","WalletPageRoutingModule","imports","forChild","exports","WalletPageModule","declarations","WalletPage","transactionService","translate","driverService","common","alertCtrl","ss","authService","settings","getUserData","then","getSettings","subscribe","res","payload","val","getDriver","valueChanges","snapshot","driver","getTransactions","records","reverse","create","header","inputs","placeholder","buttons","text","handler","data","console","log","parseFloat","balance","showAlert","widthDraw","showToast","x","present","selector","template"],"mappings":"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","file":"wallet-wallet-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"dark\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title>{{'WALLET' | translate}}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n\\n<ion-content>\\n  <div class=\\\"header\\\">\\n    <h5>{{'CURRENT_BALANCE' | translate}}</h5>\\n    <p class=\\\"amountText\\\">{{settings.currency}} {{ (driver)?.balance }}</p>\\n    <ion-button slot=\\\"end\\\" color=\\\"light\\\" size=\\\"small\\\" fill=\\\"outline\\\" (click)=\\\"withdraw()\\\">{{'REQUEST' | translate}}\\n    </ion-button>\\n  </div>\\n  <div class=\\\"ion-padding\\\" class=\\\"withdrawl-list\\\">\\n    <ion-list lines=\\\"none\\\">\\n      <p style=\\\"margin:8px\\\">{{'HISTORY' | translate}}</p>\\n      <ion-item *ngFor=\\\"let record of records\\\">\\n        <ion-icon name=\\\"logo-usd\\\" slot=\\\"start\\\"></ion-icon>\\n        <ion-label>\\n          <h3>ID: {{record.createdAt }}</h3>\\n          <p>{{ record.createdAt | date: 'dd-MMM-yyyy hh:mm a'}}</p>\\n        </ion-label>\\n        <ion-note slot=\\\"end\\\">\\n          <div class=\\\"amount\\\">{{settings.currency}} {{ record.amount }}</div>\\n          <div class=\\\"status\\\">{{ record.status}}</div>\\n        </ion-note>\\n      </ion-item>\\n    </ion-list>\\n  </div>\\n</ion-content>\";","import { Injectable } from '@angular/core';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { AuthService } from './auth.service';\nimport { TRANSACTION_TYPE_WITHDRAW } from 'src/environments/environment.prod';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TransactionService {\n\n  constructor(private db: AngularFireDatabase) { }\n\n  getTransactions(uid) {\n    return this.db.list('transactions', ref => ref.orderByChild('userId').equalTo(uid));\n  }\n\n  widthDraw(user, amount: number) {\n    return this.db.list('transactions/').push({\n      userId: user.uid,\n      name: user.name,\n      amount: amount,\n      createdAt: Date.now(),\n      type: TRANSACTION_TYPE_WITHDRAW,\n      status: 'PENDING'\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { WalletPage } from './wallet.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: WalletPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class WalletPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { WalletPageRoutingModule } from './wallet-routing.module';\n\nimport { WalletPage } from './wallet.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    WalletPageRoutingModule\n  ],\n  declarations: [WalletPage]\n})\nexport class WalletPageModule {}\n","export default \".header {\\n  min-height: 200px;\\n  text-align: center;\\n  padding: 2em;\\n  background-color: var(--ion-color-dark);\\n}\\n.header h5 {\\n  text-transform: uppercase;\\n  color: #777777;\\n  font-size: 12px;\\n  margin: 0;\\n}\\n.header .amountText {\\n  font-size: 28px;\\n  font-weight: bold;\\n  color: var(--ion-color-dark-contrast);\\n}\\nion-item {\\n  --background: #f9f9f9;\\n  margin: 8px;\\n  border-radius: 8px;\\n}\\n.footer-md:before {\\n  background: none;\\n}\\n.withdrawl-list .amount {\\n  font-weight: bold;\\n  color: var(--ion-color-dark);\\n  font-size: 16px;\\n  text-align: right;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvd2FsbGV0L3dhbGxldC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLHVDQUFBO0FBQ0o7QUFBSTtFQUNJLHlCQUFBO0VBQ0EsY0FBQTtFQUNBLGVBQUE7RUFDQSxTQUFBO0FBRVI7QUFBSTtFQUNJLGVBQUE7RUFDQSxpQkFBQTtFQUNBLHFDQUFBO0FBRVI7QUFDQTtFQUNJLHFCQUFBO0VBQ0EsV0FBQTtFQUNBLGtCQUFBO0FBRUo7QUFBQTtFQUNJLGdCQUFBO0FBR0o7QUFDSTtFQUNJLGlCQUFBO0VBQ0EsNEJBQUE7RUFDQSxlQUFBO0VBQ0EsaUJBQUE7QUFFUiIsImZpbGUiOiJzcmMvYXBwL3dhbGxldC93YWxsZXQucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmhlYWRlcntcbiAgICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgcGFkZGluZzogMmVtO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlvbi1jb2xvci1kYXJrKTtcbiAgICBoNXtcbiAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgICAgICAgY29sb3I6ICM3Nzc3Nzc7XG4gICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgICAgbWFyZ2luOjA7XG4gICAgfVxuICAgIC5hbW91bnRUZXh0e1xuICAgICAgICBmb250LXNpemU6IDI4cHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLWRhcmstY29udHJhc3QpXG4gICAgfVxufVxuaW9uLWl0ZW17XG4gICAgLS1iYWNrZ3JvdW5kOiAjZjlmOWY5O1xuICAgIG1hcmdpbjogOHB4O1xuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbn1cbi5mb290ZXItbWQ6YmVmb3Jle1xuICAgIGJhY2tncm91bmQ6IG5vbmU7XG59XG5cbi53aXRoZHJhd2wtbGlzdHtcbiAgICAuYW1vdW50e1xuICAgICAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1kYXJrKTtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICB0ZXh0LWFsaWduOiByaWdodDtcbiAgICB9XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\nimport { DriverService } from '../services/driver.service';\nimport { TransactionService } from '../services/transaction.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { CommonService } from '../services/common.service';\nimport { AlertController } from '@ionic/angular';\nimport { SettingService } from '../services/setting.service';\nimport { AuthService } from '../services/auth.service';\n\n@Component({\n  selector: 'app-wallet',\n  templateUrl: './wallet.page.html',\n  styleUrls: ['./wallet.page.scss'],\n})\nexport class WalletPage implements OnInit {\n\n  records: any;\n  driver: any;\n  settings: any = {};\n\n  constructor(private transactionService: TransactionService,\n    private translate: TranslateService,\n    private driverService: DriverService,\n    private common: CommonService,\n    private alertCtrl: AlertController,\n    private ss: SettingService,\n    private authService: AuthService\n  ) {\n\n  }\n  ionViewDidEnter() {\n    this.authService.getUserData().then(user => {\n      this.ss.getSettings().subscribe(res => res != null ? this.settings = res.payload.val() : this.settings = {});\n      this.driverService.getDriver(user.uid).valueChanges().subscribe(snapshot => this.driver = snapshot);\n      this.transactionService.getTransactions(user.uid).valueChanges().subscribe(snapshot => snapshot != null ? this.records = snapshot.reverse() : []);\n    })\n  }\n\n  withdraw() {\n\n    this.alertCtrl.create({\n      header: \"Make a Withdraw\",\n      inputs: [\n        { name: 'amount', placeholder: 'Amount' },\n      ],\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => {\n            console.log('Cancel clicked');\n          }\n        },\n        {\n          text: 'Submit',\n          handler: data => {\n            console.log(data);\n            console.log(this.driver);\n            if (parseFloat(data.amount) > parseFloat(this.driver.balance)) {\n              this.common.showAlert(\"Insufficient Balance\");\n            }\n            else {\n              this.transactionService.widthDraw(this.driver, data.amount).then(() => {\n                this.common.showToast('withdraw Requested');\n              });\n            }\n          }\n        }\n      ]\n    }).then(x => x.present());\n  }\n\n  ngOnInit() {\n  }\n\n}\n"]}