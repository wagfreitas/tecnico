{"version":3,"sources":["./src/app/pickup/pickup.page.html","./src/app/pickup/pickup-routing.module.ts","./src/app/pickup/pickup.module.ts","./src/app/pickup/pickup.page.scss","./src/app/pickup/pickup.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,ilBAAkhB,oBAAoB,2EAA2E,2BAA2B,uGAAuG,uBAAuB,0DAA0D,+PAA+P,wBAAwB,8QAA8Q,kJAAkJ,kBAAkB,mHAAmH,6BAA6B,wRAAwR,GAAG,wBAAwB,6MAA6M,iBAAiB,GAAG,UAAU,gCAAgC,oBAAoB,gcAAgc,E;;;;;;;;;;;;;;;;;;;ACArpF;AACc;AAEZ;AAE3C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,uDAAU;KACtB;CACF,CAAC;IAMW,uBAAuB,SAAvB,uBAAuB;CAAG;AAA1B,uBAAuB;IAJnC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,uBAAuB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;AChBK;AACM;AACF;AAEA;AAEqB;AAEvB;AACW;IAYzC,gBAAgB,SAAhB,gBAAgB;CAAG;AAAnB,gBAAgB;IAV5B,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,mEAAe;YACf,8EAAuB;SACxB;QACD,YAAY,EAAE,CAAC,uDAAU,CAAC;KAC3B,CAAC;GACW,gBAAgB,CAAG;AAAH;;;;;;;;;;;;;ACrB7B;AAAe,oEAAK,uBAAuB,iBAAiB,mBAAmB,oBAAoB,GAAG,WAAW,gBAAgB,GAAG,QAAQ,2BAA2B,GAAG,QAAQ,iBAAiB,GAAG,uBAAuB,sCAAsC,GAAG,mBAAmB,wBAAwB,iBAAiB,GAAG,6CAA6C,+1BAA+1B,E;;;;;;;;;;;;;;;;;;;;;;;;;;ACA/pC;AACK;AACA;AACd;AACc;AAElB;AAC4B;AACN;AACE;AACD;IAQ/C,UAAU,SAAV,UAAU;IASrB,YACU,WAAwB,EACxB,SAA0B,EAC1B,WAAwB,EACxB,MAAc,EACd,MAAqB,EACrB,SAA2B,EAC3B,EAAuB,EACvB,QAAwB,EACxB,WAAwB;QARxB,gBAAW,GAAX,WAAW,CAAa;QACxB,cAAS,GAAT,SAAS,CAAiB;QAC1B,gBAAW,GAAX,WAAW,CAAa;QACxB,WAAM,GAAN,MAAM,CAAQ;QACd,WAAM,GAAN,MAAM,CAAe;QACrB,cAAS,GAAT,SAAS,CAAkB;QAC3B,OAAE,GAAF,EAAE,CAAqB;QACvB,aAAQ,GAAR,QAAQ,CAAgB;QACxB,gBAAW,GAAX,WAAW,CAAa;QAflC,SAAI,GAAQ,EAAE,CAAC;QACf,cAAS,GAAQ,EAAE,CAAC;QACpB,kBAAa,GAAG,KAAK,CAAC;QAepB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,QAAQ,KAAK,CAAC;IAEd,eAAe;QACb,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;QAC9C,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC9D,IAAI,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,CAAC,SAAS,CAAC,CAAC,IAAS,EAAE,EAAE;YAClG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAClB,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;YAC/B,IAAI,IAAI,CAAC,MAAM,IAAI,UAAU,EAAE;gBAC7B,QAAQ,CAAC,WAAW,EAAE,CAAC;gBACvB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACvC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAChD,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,uBAAuB,CAAC,CAAC;gBAC/C,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,EAAE,EAAE,kBAAkB,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;aACpF;iBACI,IAAI,IAAI,CAAC,MAAM,IAAI,UAAU,EAAE;gBAClC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,EAAE,EAAE,kBAAkB,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;aACpF;QACH,CAAC,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,2DAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;YACrG,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC5B,CAAC,CAAC;IACJ,CAAC;IAGD,UAAU;QACR,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,OAAO,EAAE,+BAA+B;YACxC,OAAO,EAAE,CAAC;oBACR,IAAI,EAAE,KAAK;oBACX,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;iBACtD,EAAE;oBACD,IAAI,EAAE,KAAK;iBACZ,CAAC;SACH,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;IAChC,CAAC;IAED,SAAS;IACT,MAAM;QACJ,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,SAAS,EAAE,mCAAmC;YAC9C,MAAM,EAAE,CAAC;oBACP,IAAI,EAAE,KAAK;oBACX,WAAW,EAAE,WAAW;oBACxB,IAAI,EAAE,KAAK;iBACZ,CAAC;YACF,OAAO,EAAE,CAAC;oBACR,IAAI,EAAE,WAAW;oBACjB,OAAO,EAAE,CAAC,IAAI,EAAE,EAAE;wBAChB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;wBAClB,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,2DAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,GAAQ,EAAE,EAAE;4BAC3F,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;4BACjB,IAAI,GAAG,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG;gCAAE,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;iCAC7D;gCACH,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;gCAC1B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;6BACxC;wBACH,CAAC,CAAC;oBACJ,CAAC;iBACF,CAAC;SACH,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;IAChC,CAAC;IAED,YAAY,CAAC,GAAG,EAAE,GAAG;QACnB,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACpB,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;YAC/C,GAAG,CAAC,MAAM,CAAC,QAAQ;YACnB,IAAI,GAAG,GAAG,mEAAmE,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,GAAG,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,SAAS,GAAG,eAAe,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;YACrK,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;YACb,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACxB,CAAC,CAAC;IACJ,CAAC;IAGD,WAAW;QACT,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,MAAM,EAAE,iCAAiC;YACzC,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,KAAK;oBACX,OAAO,EAAE,GAAG,EAAE;wBACZ,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBACxC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;wBAChD,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;oBACrC,CAAC;iBACF;gBACD;oBACE,IAAI,EAAE,KAAK;iBACZ;aACF;SACF,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;IAChC,CAAC;CACF;;YArIQ,kEAAW;YAKX,8DAAe;YAHf,kEAAW;YADX,sDAAM;YAKN,sEAAa;YAPb,oEAAgB;YAQhB,0EAAmB;YAFF,6DAAc;YAG/B,0EAAW;;AAQP,UAAU;IALtB,+DAAS,CAAC;QACT,QAAQ,EAAE,YAAY;QACtB,oNAAiC;;KAElC,CAAC;GACW,UAAU,CAqHtB;AArHsB","file":"pickup-pickup-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"dark\\\">\\n    <ion-title> Dados do Atendimento </ion-title>\\n    <ion-buttons slot=\\\"end\\\" *ngIf=\\\"trip.status == 'waiting'\\\">\\n      <ion-button color=\\\"danger\\\" fill=\\\"solid\\\" (click)=\\\"cancelTrip()\\\">CANCELA\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card>\\n    <ion-card-content>\\n      <ion-list lines=\\\"none\\\">\\n        <ion-item *ngIf=\\\"passenger.phoneNumber\\\">\\n          <ion-label>\\n            <ion-text>\\n              <h2>{{(passenger)?.name }}</h2>\\n            </ion-text>\\n            <ion-text>\\n              <p>{{(passenger)?.phoneNumber }}</p>\\n            </ion-text>\\n          </ion-label>\\n          <ion-button slot=\\\"end\\\" href=\\\"tel:{{passenger.phoneNumber}}\\\">\\n            <ion-icon name=\\\"call\\\"></ion-icon>&nbsp; FONE\\n          </ion-button>\\n\\n        </ion-item>\\n        <ion-item>\\n          <ion-label>\\n            <ion-text>\\n              <h2>LOCAL</h2>\\n            </ion-text>\\n            <ion-text>\\n              <p *ngIf=\\\"trip.origin != undefined\\\">{{ trip.origin.vicinity }}</p>\\n            </ion-text>\\n          </ion-label>\\n          <ion-button slot=\\\"end\\\" fill=\\\"outline\\\" color=\\\"dark\\\"\\n            (click)=\\\"getDirection(trip.origin.location.lat,trip.origin.location.lng)\\\">\\n            <ion-icon name=\\\"navigate\\\"></ion-icon>&nbsp; NAVEGAR\\n          </ion-button>\\n        </ion-item>\\n        <!--ion-item>\\n          <ion-label>\\n            <ion-text>\\n              <h2>{{'TO' | translate}}</h2>\\n            </ion-text>\\n            <ion-text>\\n              <p *ngIf=\\\"trip.destination != undefined\\\">{{ trip.destination.vicinity }}</p>\\n            </ion-text>\\n          </ion-label>\\n          <ion-button slot=\\\"end\\\" fill=\\\"outline\\\" color=\\\"dark\\\"\\n            (click)=\\\"getDirection(trip.destination.location.lat,trip.destination.location.lng)\\\">\\n            <ion-icon name=\\\"navigate\\\"></ion-icon>&nbsp; {{'NAVIGATE' | translate}}\\n          </ion-button>\\n        </ion-item-->\\n      </ion-list>\\n    </ion-card-content>\\n  </ion-card>\\n  <div class=\\\"ion-padding\\\">\\n    <table>\\n      <tr>\\n        <td>TOTAL: </td>\\n        <td>{{ trip.currency }} {{trip.fee}} <span class=\\\"payment-mode\\\">{{trip.paymentMethod}}</span></td>\\n      </tr>\\n    </table>\\n  </div>\\n</ion-content>\\n<ion-footer class=\\\"ion-padding\\\">\\n  <ion-toolbar>\\n    <ion-button *ngIf=\\\"trip.status == 'waiting'\\\" expand=\\\"block\\\" color=\\\"dark\\\" (click)=\\\"pickup()\\\">INICIAR ATENDIMENTO\\n    </ion-button>\\n    <ion-button *ngIf=\\\"trip.status == 'going'\\\" expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"showPayment()\\\">\\n     COMPLETAR ATENDIMENTO</ion-button>\\n  </ion-toolbar>\\n</ion-footer>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { PickupPage } from './pickup.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PickupPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class PickupPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { PickupPageRoutingModule } from './pickup-routing.module';\n\nimport { PickupPage } from './pickup.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    PickupPageRoutingModule\n  ],\n  declarations: [PickupPage]\n})\nexport class PickupPageModule {}\n","export default \"h3 {\\n  text-align: center;\\n  padding: 8px;\\n  color: #4CAF50;\\n  font-size: 2rem;\\n}\\n\\ntable {\\n  width: 100%;\\n}\\n\\ntr {\\n  border: 1px solid #eee;\\n}\\n\\ntd {\\n  padding: 4px;\\n}\\n\\n.footer-md:before {\\n  background-image: none !important;\\n}\\n\\n.payment-mode {\\n  background: #f2f2f2;\\n  padding: 2px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGlja3VwL3BpY2t1cC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxrQkFBQTtFQUNBLFlBQUE7RUFDQSxjQUFBO0VBQ0EsZUFBQTtBQUNKOztBQUVBO0VBQ0ksV0FBQTtBQUNKOztBQUVBO0VBQ0ksc0JBQUE7QUFDSjs7QUFFQTtFQUNJLFlBQUE7QUFDSjs7QUFFQTtFQUNJLGlDQUFBO0FBQ0o7O0FBRUE7RUFDSSxtQkFBQTtFQUNBLFlBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3BpY2t1cC9waWNrdXAucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaDN7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHBhZGRpbmc6IDhweDtcbiAgICBjb2xvcjogIzRDQUY1MDtcbiAgICBmb250LXNpemU6IDJyZW07XG59XG5cbnRhYmxle1xuICAgIHdpZHRoOiAxMDAlO1xufVxuXG50cntcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWVlO1xufVxuXG50ZHtcbiAgICBwYWRkaW5nOiA0cHg7XG59XG5cbi5mb290ZXItbWQ6YmVmb3Jle1xuICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmUgIWltcG9ydGFudDtcbn1cblxuLnBheW1lbnQtbW9kZXtcbiAgICBiYWNrZ3JvdW5kOiAjZjJmMmYyO1xuICAgIHBhZGRpbmc6MnB4O1xufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { TripService } from '../services/trip.service';\nimport { Router } from '@angular/router';\nimport { DealService } from '../services/deal.service';\nimport { Observable } from 'rxjs';\nimport { take } from 'rxjs/operators'\nimport { AlertController, MenuController } from '@ionic/angular';\nimport { CommonService } from '../services/common.service';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\n\n\n@Component({\n  selector: 'app-pickup',\n  templateUrl: './pickup.page.html',\n  styleUrls: ['./pickup.page.scss'],\n})\nexport class PickupPage implements OnInit {\n\n\n  trip: any = {};\n  passenger: any = {};\n  isTripStarted = false;\n  discount;\n  tax;\n\n  constructor(\n    private tripService: TripService,\n    private alertCtrl: AlertController,\n    private dealService: DealService,\n    private router: Router,\n    private common: CommonService,\n    private translate: TranslateService,\n    private db: AngularFireDatabase,\n    private menuCtrl: MenuController,\n    private geolocation: Geolocation\n  ) {\n    this.menuCtrl.enable(true);\n  }\n\n  ngOnInit() { }\n\n  ionViewDidEnter() {\n    this.trip = this.tripService.getCurrentTrip();\n    this.discount = (this.trip.rawfee * (this.trip.discount / 100)).toFixed(2)\n    this.tax = (this.trip.fee * (this.trip.tax / 100)).toFixed(2);\n    let getTrips = this.tripService.getTripStatus(this.trip.key).valueChanges().subscribe((trip: any) => {\n      console.log(trip);\n      this.trip.status = trip.status;\n      if (trip.status == 'canceled') {\n        getTrips.unsubscribe();\n        this.tripService.cancel(this.trip.key);\n        this.dealService.removeDeal(this.trip.driverId);\n        this.common.showAlert(\"Atendimento Cancelado\");\n        this.router.navigateByUrl('/home', { skipLocationChange: true, replaceUrl: true });\n      }\n      else if (trip.status == 'finished') {\n        this.router.navigateByUrl('/home', { skipLocationChange: true, replaceUrl: true });\n      }\n    })\n    this.tripService.getPassenger(this.trip.passengerId).valueChanges().pipe(take(1)).subscribe(snapshot => {\n      this.passenger = snapshot;\n    })\n  }\n\n\n  cancelTrip() {\n    this.alertCtrl.create({\n      message: \"Deseja cancelar o atendimento\",\n      buttons: [{\n        text: \"Sim\",\n        handler: () => this.tripService.cancel(this.trip.key)\n      }, {\n        text: \"Não\"\n      }]\n    }).then(res => res.present());\n  }\n\n  // pickup\n  pickup() {\n    this.alertCtrl.create({\n      subHeader: \"Entre com o Código de Atendimento\",\n      inputs: [{\n        name: 'otp',\n        placeholder: '4 digitos',\n        type: 'tel',\n      }],\n      buttons: [{\n        text: \"Verificar\",\n        handler: (data) => {\n          console.log(data);\n          this.db.object('trips/' + this.trip.key).valueChanges().pipe(take(1)).subscribe((res: any) => {\n            console.log(res);\n            if (res.otp != data.otp) this.common.showAlert(\"Código Inválido\");\n            else {\n              this.isTripStarted = true;\n              this.tripService.pickUp(this.trip.key);\n            }\n          })\n        }\n      }]\n    }).then(res => res.present());\n  }\n\n  getDirection(lat, lng) {\n    console.log(\"call\");\n    this.geolocation.getCurrentPosition().then(geo => {\n      geo.coords.latitude\n      let url = \"https://www.google.com/maps/dir/?api=1&travelmode=driving&origin=\" + geo.coords.latitude + \",\" + geo.coords.longitude + \"&destination=\" + lat + \",\" + lng;\n      window.open(url);\n    }).catch(err => {\n      console.log(\"Error \");\n    })\n  }\n\n\n  showPayment() {\n    this.alertCtrl.create({\n      header: \"Deseja completar o atendimento?\",\n      buttons: [\n        {\n          text: 'Sim',\n          handler: () => {\n            this.tripService.dropOff(this.trip.key);\n            this.dealService.removeDeal(this.trip.driverId);\n            this.router.navigateByUrl('/home');\n          }\n        },\n        {\n          text: \"Não\"\n        }\n      ]\n    }).then(res => res.present());\n  }\n}\n"],"sourceRoot":"webpack:///"}