{"version":3,"sources":["webpack:///src/app/home/home.page.html","webpack:///src/app/home/home-routing.module.ts","webpack:///src/app/home/home.module.ts","webpack:///src/app/home/home.page.scss","webpack:///src/app/home/home.page.ts"],"names":["routes","path","component","HomePageRoutingModule","imports","forChild","exports","HomePageModule","declarations","HomePage","driverService","alertCtrl","dealService","authService","placeService","geolocation","translate","router","menuCtrl","platform","common","permission","afAuth","loadCtrl","tripService","driver","isDriverAvailable","dealStatus","position","remainingTime","lat","lng","latLng","google","maps","LatLng","mapOptions","center","mapTypeId","MapTypeId","ROADMAP","map","Map","document","getElementById","marker","Marker","animation","Animation","DROP","icon","url","size","Size","origin","Point","anchor","scaledSize","clearInterval","positionTracking","console","log","isOnline","is","checkPermission","PERMISSION","ACCESS_FINE_LOCATION","then","res","showToast","hasPermission","requestPermission","err","getCurrentPosition","enableHighAccuracy","timeout","resp","getDriver","uid","update","coords","latitude","longitude","geocoder","Geocoder","loadMap","geocode","results","status","GeocoderStatus","OK","locality","setLocalityFromGeocoder","setInterval","type","updatePosition","rating","name","location","setPosition","setCenter","message","watchDeals","dismiss","remove","dealSubscription","unsubscribe","interval","dealAlert","subHeader","cancelDeal","confirmJob","removeDeal","enable","onAuthStateChanged","user","valueChanges","subscribe","snapshot","pause","pipe","cordova","plugins","backgroundMode","setDefaults","id","title","text","hidden","silent","setEnabled","on","disableWebViewOptimizations","disableBatteryOptimizations","resume","getLastTrips","trips","forEach","trip","setCurrentTrip","key","navigateByUrl","n","Array","Math","round","job","distance","vicinity","create","header","cssClass","buttons","role","handler","acceptDeal","deal","present","playAudio","getDeal","undefined","createdAt","Date","now","calcCrow","toFixed","destination","countDown","audio","Audio","play","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,qBAAqB;AAAA;AAAA,O;;AAArBA,2BAAqB,6DAJjC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIiC,GAArBH,qBAAqB,CAArB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCKAI,cAAc;AAAA;AAAA,O;;AAAdA,oBAAc,6DAV1B,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,mEAJO,EAKP,0EALO,CADD;AAQRI,oBAAY,EAAE,CAAC,mDAAD;AARN,OAAT,CAU0B,GAAdD,cAAc,CAAd;;;;;;;;;;;;;;;;ACrBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UC2BFE,QAAQ;AAgBnB,0BACUC,aADV,EAEUC,SAFV,EAGUC,WAHV,EAIUC,WAJV,EAKUC,YALV,EAMUC,WANV,EAOUC,SAPV,EAQUC,MARV,EASUC,QATV,EAUUC,QAVV,EAWUC,MAXV,EAYUC,UAZV,EAaUC,MAbV,EAcUC,QAdV,EAeUC,WAfV,EAekC;AAAA;;AAdxB,eAAAd,aAAA,GAAAA,aAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,WAAA,GAAAA,WAAA;AACA,eAAAC,WAAA,GAAAA,WAAA;AACA,eAAAC,YAAA,GAAAA,YAAA;AACA,eAAAC,WAAA,GAAAA,WAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,UAAA,GAAAA,UAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,WAAA,GAAAA,WAAA;AA7BV,eAAAC,MAAA,GAAc,EAAd;AAGA,eAAAC,iBAAA,GAAoB,KAApB;AAEA,eAAAC,UAAA,GAAa,KAAb;AAEA,eAAAC,QAAA,GAAgB,EAAhB;AAKO,eAAAC,aAAA,GAAgB,8EAAhB;AAoBN;;AAlCkB;AAAA;AAAA,kCAqCXC,GArCW,EAqCNC,GArCM,EAqCD;AAChB,gBAAIC,MAAM,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuBL,GAAvB,EAA4BC,GAA5B,CAAb;AAEA,gBAAIK,UAAU,GAAQ,8EAAYA,UAAlC;AACAA,sBAAU,CAACC,MAAX,GAAoBL,MAApB;AACAI,sBAAU,CAACE,SAAX,GAAuBL,MAAM,CAACC,IAAP,CAAYK,SAAZ,CAAsBC,OAA7C;AAEA,iBAAKC,GAAL,GAAW,IAAIR,MAAM,CAACC,IAAP,CAAYQ,GAAhB,CAAoBC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAApB,EAAoDR,UAApD,CAAX;AAEA,iBAAKS,MAAL,GAAc,IAAIZ,MAAM,CAACC,IAAP,CAAYY,MAAhB,CAAuB;AACnCL,iBAAG,EAAE,KAAKA,GADyB;AAEnCM,uBAAS,EAAEd,MAAM,CAACC,IAAP,CAAYc,SAAZ,CAAsBC,IAFE;AAGnCrB,sBAAQ,EAAEI,MAHyB;AAInCkB,kBAAI,EAAE;AACJC,mBAAG,EAAE,yBADD;AAEJC,oBAAI,EAAE,IAAInB,MAAM,CAACC,IAAP,CAAYmB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB,CAFF;AAGJC,sBAAM,EAAE,IAAIrB,MAAM,CAACC,IAAP,CAAYqB,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,CAHJ;AAIJC,sBAAM,EAAE,IAAIvB,MAAM,CAACC,IAAP,CAAYqB,KAAhB,CAAsB,EAAtB,EAA0B,EAA1B,CAJJ;AAKJE,0BAAU,EAAE,IAAIxB,MAAM,CAACC,IAAP,CAAYmB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB;AALR;AAJ6B,aAAvB,CAAd;AAYD;AA1DkB;AAAA;AAAA,+CA4DE;AAAA;;AACnBK,yBAAa,CAAC,KAAKC,gBAAN,CAAb;AACAC,mBAAO,CAACC,GAAR,CAAY,KAAKpC,MAAL,CAAYqC,QAAxB;;AAEA,gBAAI,KAAK3C,QAAL,CAAc4C,EAAd,CAAiB,QAAjB,KAA8B,KAAKtC,MAAL,CAAYqC,QAAZ,IAAwB,IAA1D,EAAgE;AAC9D;AACA,mBAAKzC,UAAL,CAAgB2C,eAAhB,CAAgC,KAAK3C,UAAL,CAAgB4C,UAAhB,CAA2BC,oBAA3D,EAAiFC,IAAjF,CAAsF,UAACC,GAAD,EAAS;AAC7F,qBAAI,CAAChD,MAAL,CAAYiD,SAAZ,CAAsB,8BAA8BD,GAAG,CAACE,aAAxD;;AACA,oBAAI,CAACF,GAAG,CAACE,aAAT,EAAwB;AACtB,uBAAI,CAACjD,UAAL,CAAgBkD,iBAAhB,CAAkC,KAAI,CAAClD,UAAL,CAAgB4C,UAAhB,CAA2BC,oBAA7D,EAAmFC,IAAnF,CAAwF,UAAAC,GAAG,EAAI;AAC7FR,2BAAO,CAACC,GAAR,CAAYO,GAAZ;AACD,mBAFD,WAES,UAAAI,GAAG,EAAI;AACdZ,2BAAO,CAACC,GAAR,CAAYW,GAAZ;AACD,mBAJD;AAKD;AACF,eATD,WASS,UAAAA,GAAG,EAAI;AACdZ,uBAAO,CAACC,GAAR,CAAYW,GAAZ;AACD,eAXD;AAaD;;AAED,gBAAI,KAAK/C,MAAL,CAAYqC,QAAZ,IAAwB,IAA5B,EAAkC;AAEhC;AACD;AAEC;AACA,mBAAK/C,WAAL,CAAiB0D,kBAAjB,CAAoC;AAClCC,kCAAkB,EAAE,IADc;AAElCC,uBAAO,EAAE;AAFyB,eAApC,EAGGR,IAHH,CAGQ,UAACS,IAAD,EAAU;AAChB;AACA;AAEA,qBAAI,CAAClE,aAAL,CAAmBmE,SAAnB,CAA6B,KAAI,CAACpD,MAAL,CAAYqD,GAAzC,EAA8CC,MAA9C,CAAqD;AAAEjB,0BAAQ,EAAE;AAAZ,iBAArD,EAJgB,CAKhB;;;AAEA,qBAAI,CAAClC,QAAL,GAAgB,CAACgD,IAAI,CAACI,MAAL,CAAYC,QAAb,EAAuBL,IAAI,CAACI,MAAL,CAAYE,SAAnC,CAAhB;AACAtB,uBAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB,KAAI,CAACjC,QAA7B;AAEA,oBAAII,MAAM,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuByC,IAAI,CAACI,MAAL,CAAYC,QAAnC,EAA6CL,IAAI,CAACI,MAAL,CAAYE,SAAzD,CAAb;AACA,oBAAIC,QAAQ,GAAG,IAAIlD,MAAM,CAACC,IAAP,CAAYkD,QAAhB,EAAf;;AAEA,qBAAI,CAACC,OAAL,CAAaT,IAAI,CAACI,MAAL,CAAYC,QAAzB,EAAmCL,IAAI,CAACI,MAAL,CAAYE,SAA/C,EAbgB,CAchB;;;AACAC,wBAAQ,CAACG,OAAT,CAAiB;AAAE,4BAAUtD;AAAZ,iBAAjB,EAAuC,UAACuD,OAAD,EAAUC,MAAV,EAAqB;AAC1D,sBAAIA,MAAM,IAAIvD,MAAM,CAACC,IAAP,CAAYuD,cAAZ,CAA2BC,EAAzC,EAA6C;AAC3C;AACA;AACA,yBAAI,CAACC,QAAL,GAAgB,KAAI,CAAC7E,YAAL,CAAkB8E,uBAAlB,CAA0CL,OAA1C,CAAhB,CAH2C,CAI5C;AAEC;;AACA,yBAAI,CAAC5B,gBAAL,GAAwBkC,WAAW,CAAC,YAAM;AACxC;AACA;AACA,0BAAI,CAAC,KAAI,CAACpE,MAAN,IAAgB,CAAC,KAAI,CAACA,MAAL,CAAYqE,IAAjC,EAAuC;;AAGvC,0BAAI,KAAI,CAACrE,MAAL,CAAYqC,QAAhB,EAA2B;AACzB;AACA,6BAAI,CAAC/C,WAAL,CAAiB0D,kBAAjB,CAAoC;AAClCC,4CAAkB,EAAE,IADc;AAElCC,iCAAO,EAAE;AAFyB,yBAApC,EAGGR,IAHH,CAGQ,UAACS,IAAD,EAAU;AAChBhB,iCAAO,CAACC,GAAR,CAAYe,IAAZ;;AACA,+BAAI,CAAClE,aAAL,CAAmBqF,cAAnB,CAAkC,KAAI,CAACtE,MAAL,CAAYqD,GAA9C,EAAmD,KAAI,CAACrD,MAAL,CAAYqE,IAA/D,EAAqE,KAAI,CAACH,QAA1E,EAAoFf,IAAI,CAACI,MAAL,CAAYC,QAAhG,EAA0GL,IAAI,CAACI,MAAL,CAAYE,SAAtH,EAAiI,KAAI,CAACzD,MAAL,CAAYuE,MAA7I,EAAqJ,KAAI,CAACvE,MAAL,CAAYwE,IAAjK;;AAGA,8BAAIC,QAAQ,GAAG,IAAIjE,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuByC,IAAI,CAACI,MAAL,CAAYC,QAAnC,EAA6CL,IAAI,CAACI,MAAL,CAAYE,SAAzD,CAAf;;AAEA,+BAAI,CAACrC,MAAL,CAAYsD,WAAZ,CAAwBD,QAAxB;;AACA,+BAAI,CAACzD,GAAL,CAAS2D,SAAT,CAAmBF,QAAnB;AAED,yBAbD,EAaG,UAAA1B,GAAG,EAAI;AACR,+BAAI,CAACpD,MAAL,CAAYiD,SAAZ,CAAsBG,GAAG,CAAC6B,OAA1B;;AACAzC,iCAAO,CAACC,GAAR,CAAYW,GAAZ;AACD,yBAhBD;AAkBD;AAEF,qBA5BkC,EA4BhC,mFA5BgC,CAAnC;;AA+BA,yBAAI,CAAC8B,UAAL;AACD;AACF,iBAzCD;AA0CD,eA5DD,EA4DG,UAAC9B,GAAD,EAAS;AACVZ,uBAAO,CAACC,GAAR,CAAYW,GAAZ;;AACA,qBAAI,CAACjD,QAAL,CAAcgF,OAAd;;AACA,qBAAI,CAACnF,MAAL,CAAYiD,SAAZ,CAAsB,qGAAtB;;AACA,qBAAI,CAAC5C,MAAL,CAAYqC,QAAZ,GAAuB,KAAvB;;AACA,qBAAI,CAACpD,aAAL,CAAmBmE,SAAnB,CAA6B,KAAI,CAACpD,MAAL,CAAYqD,GAAzC,EAA8CC,MAA9C,CAAqD;AAAEjB,0BAAQ,EAAE;AAAZ,iBAArD;AACD,eAlED;AAoED,aA1ED,MA2EK;AACHJ,2BAAa,CAAC,KAAKC,gBAAN,CAAb;AACA,mBAAKjD,aAAL,CAAmBmE,SAAnB,CAA6B,KAAKpD,MAAL,CAAYqD,GAAzC,EAA8CC,MAA9C,CAAqD;AAAEjB,wBAAQ,EAAE;AAAZ,eAArD;AACA,mBAAKpD,aAAL,CAAmB8F,MAAnB,CAA0B,KAAK/E,MAAL,CAAYqD,GAAtC,EAA2C,KAAKrD,MAAL,CAAYqE,IAAvD,EAA6D,KAAKH,QAAlE;AACA,kBAAI,KAAKc,gBAAT,EAA2B,KAAKA,gBAAL,CAAsBC,WAAtB;AAC3B,mBAAKtF,MAAL,CAAYiD,SAAZ,CAAsB,yBAAtB;AACD;AAEF,WApKkB,CAsKnB;;AAtKmB;AAAA;AAAA,sCAuKP;AAAA;;AACV,gBAAIsC,QAAQ,GAAGd,WAAW,CAAC,YAAM;AAC/B,oBAAI,CAAChE,aAAL;AACA,oBAAI,CAAC+E,SAAL,CAAeC,SAAf,GAA2B,mBAAmB,MAAI,CAAChF,aAAxB,GAAwC,MAAnE;;AACA,kBAAI,MAAI,CAACA,aAAL,IAAsB,CAA1B,EAA6B;AAC3B6B,6BAAa,CAACiD,QAAD,CAAb;;AACA,sBAAI,CAACG,UAAL;;AACA,sBAAI,CAACjF,aAAL,GAAqB,8EAArB;AACD;AACF,aARyB,EAQvB,IARuB,CAA1B;AASA,iBAAKkF,UAAL;AACD;AAlLkB;AAAA;AAAA,uCAoLN;AACXnD,mBAAO,CAACC,GAAR,CAAY,OAAZ;AACA,iBAAKlC,UAAL,GAAkB,KAAlB;AACA,iBAAKiF,SAAL,CAAeL,OAAf;AACA,iBAAK3F,WAAL,CAAiBoG,UAAjB,CAA4B,KAAKvF,MAAL,CAAYqD,GAAxC;AACD;AAzLkB;AAAA;AAAA,4CA2LD;AAAA;;AAChB,iBAAK5D,QAAL,CAAc+F,MAAd,CAAqB,IAArB;AAEA,iBAAK3F,MAAL,CAAY4F,kBAAZ,CAA+B,UAACC,IAAD,EAAU;AACvCvD,qBAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBsD,IAApB;;AACA,kBAAIA,IAAI,IAAI,IAAZ,EAAkB;AAChB,sBAAI,CAACzG,aAAL,CAAmBmE,SAAnB,CAA6BsC,IAAI,CAACrC,GAAlC,EAAuCsC,YAAvC,GAAsDC,SAAtD,CAAgE,UAACC,QAAD,EAAmB;AAClF;AACC,sBAAIA,QAAQ,IAAI,IAAhB,EAAsB;AACpB,0BAAI,CAAC7F,MAAL,GAAc6F,QAAd;;AACA,wBAAI,MAAI,CAAC7F,MAAL,CAAYqC,QAAZ,IAAwB,MAAI,CAAC3C,QAAL,CAAc4C,EAAd,CAAiB,QAAjB,CAA5B,EAAwD;AAEtD;AAEA,4BAAI,CAAC5C,QAAL,CAAcoG,KAAd,CAAoBC,IAApB,CAAyB,6DAAK,CAAL,CAAzB,EAAkCH,SAAlC,CAA4C,YAAM;AAChD,4BAAI,MAAI,CAAC5F,MAAL,CAAYqC,QAAhB,EAA0B;AACxBF,iCAAO,CAACC,GAAR,CAAY,eAAZ;AACA4D,iCAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BC,WAA/B,CAA2C;AAAEC,8BAAE,EAAE,CAAC,CAAP;AAAUC,iCAAK,EAAE,uBAAjB;AAA0CC,gCAAI,EAAE,YAAhD;AAA8DC,kCAAM,EAAE,KAAtE;AAA6EC,kCAAM,EAAE;AAArF,2BAA3C;AAEAR,iCAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BO,UAA/B,CAA0C,IAA1C;AACAT,iCAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BQ,EAA/B,CAAkC,QAAlC,EAA4C,YAAM;AAChDvE,mCAAO,CAACC,GAAR,CAAY,6BAAZ;AAEA4D,mCAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BS,2BAA/B;AACAX,mCAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BU,2BAA/B;AACD,2BALD;AAMD;AACF,uBAbD;;AAeAZ,6BAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BQ,EAA/B,CAAkC,QAAlC,EAA4C;AAAA,+BAAMvE,OAAO,CAACC,GAAR,CAAY,aAAZ,CAAN;AAAA,uBAA5C;AAEA4D,6BAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BQ,EAA/B,CAAkC,YAAlC,EAAgD;AAAA,+BAAMvE,OAAO,CAACC,GAAR,CAAY,eAAZ,CAAN;AAAA,uBAAhD;AAEA4D,6BAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BQ,EAA/B,CAAkC,SAAlC,EAA6C;AAAA,+BAAMvE,OAAO,CAACC,GAAR,CAAY,aAAZ,CAAN;AAAA,uBAA7C;AAEA4D,6BAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BQ,EAA/B,CAAkC,SAAlC,EAA6C,YAAM;AACjDvE,+BAAO,CAACC,GAAR,CAAY,cAAZ;AACD,uBAFD,EAzBsD,CA8BtD;;AACA,4BAAI,CAAC1C,QAAL,CAAcmH,MAAd,CAAqBd,IAArB,CAA0B,6DAAK,CAAL,CAA1B,EAAmCH,SAAnC,CAA6C;AAAA,+BAAMI,OAAO,CAACC,OAAR,CAAgBC,cAAhB,CAA+BO,UAA/B,CAA0C,KAA1C,CAAN;AAAA,uBAA7C;AACD;AACF;AACF,iBAtCD;;AAwCA,sBAAI,CAAC1G,WAAL,CAAiB+G,YAAjB,CAA8BpB,IAAI,CAACrC,GAAnC,EAAwCsC,YAAxC,GAAuDI,IAAvD,CAA4D,6DAAK,CAAL,CAA5D,EAAqEH,SAArE,CAA+E,UAACmB,KAAD,EAAgB;AAC7FA,uBAAK,CAACC,OAAN,CAAc,UAAAC,IAAI,EAAI;AACpB,wBAAIA,IAAI,CAAClD,MAAL,IAAe,qFAAf,IAAsCkD,IAAI,CAAClD,MAAL,IAAe,mFAAzD,EAA4E;AAC1E,4BAAI,CAAChE,WAAL,CAAiBmH,cAAjB,CAAgCD,IAAI,CAACE,GAArC;;AACA,4BAAI,CAAC3H,MAAL,CAAY4H,aAAZ,CAA0B,SAA1B;AACD;AACF,mBALD;AAMD,iBAPD;AASD;AACF,aArDD;AAyDD;AAvPkB;AAAA;AAAA,gCAyPbC,CAzPa,EAyPV;AACP,mBAAO,IAAIC,KAAJ,CAAUC,IAAI,CAACC,KAAL,CAAWH,CAAX,CAAV,CAAP;AACD,WA3PkB,CA6PnB;;AA7PmB;AAAA;AAAA,uCA8PN;AAAA;;AACX;AACA,gBAAIzC,OAAO,GAAG,oBAAoB,KAAK6C,GAAL,CAAS5F,MAAT,CAAgB6F,QAApC,GAA+C,UAA/C,GAA4D,KAAKD,GAAL,CAAS5F,MAAT,CAAgB8F,QAA1F,CAFW,CAGX;;AAEA,iBAAKzI,SAAL,CAAe0I,MAAf,CAAsB;AACpBxB,gBAAE,EAAE,KAAKqB,GAAL,CAASN,GADO;AAEpBU,oBAAM,EAAE,kBAFY;AAGpBjD,qBAAO,EAAEA,OAHW;AAIpBkD,sBAAQ,EAAE,aAJU;AAKpBC,qBAAO,EAAE,CACP;AACEzB,oBAAI,EAAE,UADR;AAEE0B,oBAAI,EAAE,QAFR;AAGEC,uBAAO,EAAE,mBAAM;AACf;AACE,wBAAI,CAAC/H,UAAL,GAAkB,KAAlB;;AACA,wBAAI,CAACf,WAAL,CAAiBoG,UAAjB,CAA4B,MAAI,CAACvF,MAAL,CAAYqD,GAAxC;AACD;AAPH,eADO,EAUP;AACEiD,oBAAI,EAAE,SADR;AAEE2B,uBAAO,EAAE,mBAAM;AACb,wBAAI,CAAC/H,UAAL,GAAkB,KAAlB;;AACA,wBAAI,CAACf,WAAL,CAAiB+I,UAAjB,CAA4B,MAAI,CAAClI,MAAL,CAAYqD,GAAxC,EAA6C,MAAI,CAAC8E,IAAlD,EAAwDzF,IAAxD,CAA6D,YAAM;AACjE,0BAAI,CAAClD,MAAL,CAAY4H,aAAZ,CAA0B,QAA1B;AACD,mBAFD;AAGD;AAPH,eAVO;AALW,aAAtB,EAyBG1E,IAzBH,CAyBQ,UAAAC,GAAG,EAAI;AACb,oBAAI,CAACwC,SAAL,GAAiBxC,GAAjB;;AACA,oBAAI,CAACwC,SAAL,CAAeiD,OAAf;AACD,aA5BD;AA8BA,iBAAKC,SAAL;AACD,WAlSkB,CAqSnB;;AArSmB;AAAA;AAAA,uCAsSN;AAAA;;AACX;AACA,iBAAKrD,gBAAL,GAAwB,KAAK7F,WAAL,CAAiBmJ,OAAjB,CAAyB,KAAKtI,MAAL,CAAYqD,GAArC,EAA0CsC,YAA1C,GAAyDC,SAAzD,CAAmE,UAACC,QAAD,EAAmB;AAC5G,kBAAIA,QAAQ,IAAI,IAAZ,IAAoBA,QAAQ,IAAI0C,SAApC,EAA+C;AAC7C,sBAAI,CAACJ,IAAL,GAAYtC,QAAZ;;AACA,oBAAIA,QAAQ,CAAC9B,MAAT,IAAmB,qFAAvB,EAA4C;AAC1C;AACA,sBAAI8B,QAAQ,CAAC2C,SAAT,GAAsBC,IAAI,CAACC,GAAL,KAAa,iFAAe,IAAtD,EAA6D;AAC3D,2BAAO,MAAI,CAACvJ,WAAL,CAAiBoG,UAAjB,CAA4B,MAAI,CAACvF,MAAL,CAAYqD,GAAxC,CAAP;AACD;;AACD,wBAAI,CAACnD,UAAL,GAAkB,IAAlB;AACA,wBAAI,CAACuH,GAAL,GAAW5B,QAAX;;AAEA,wBAAI,CAACvG,WAAL,CAAiB0D,kBAAjB,CAAoC;AAClCC,sCAAkB,EAAE,IADc;AAElCC,2BAAO,EAAE;AAFyB,mBAApC,EAGGR,IAHH,CAGQ,UAACS,IAAD,EAAU;AAChB;AACA,0BAAI,CAACsE,GAAL,CAAS5F,MAAT,CAAgB6F,QAAhB,GAA2B,MAAI,CAACrI,YAAL,CAAkBsJ,QAAlB,CAA2BxF,IAAI,CAACI,MAAL,CAAYC,QAAvC,EAAiDL,IAAI,CAACI,MAAL,CAAYE,SAA7D,EAAwE,MAAI,CAACgE,GAAL,CAAS5F,MAAT,CAAgB4C,QAAhB,CAAyBpE,GAAjG,EAAsG,MAAI,CAACoH,GAAL,CAAS5F,MAAT,CAAgB4C,QAAhB,CAAyBnE,GAA/H,EAAoIsI,OAApI,CAA4I,CAA5I,CAA3B;AACA,0BAAI,CAACnB,GAAL,CAASoB,WAAT,CAAqBnB,QAArB,GAAgC,MAAI,CAACrI,YAAL,CAAkBsJ,QAAlB,CAA2BxF,IAAI,CAACI,MAAL,CAAYC,QAAvC,EAAiDL,IAAI,CAACI,MAAL,CAAYE,SAA7D,EAAwE,MAAI,CAACgE,GAAL,CAASoB,WAAT,CAAqBpE,QAArB,CAA8BpE,GAAtG,EAA2G,MAAI,CAACoH,GAAL,CAASoB,WAAT,CAAqBpE,QAArB,CAA8BnE,GAAzI,EAA8IsI,OAA9I,CAAsJ,CAAtJ,CAAhC;;AACA,0BAAI,CAACE,SAAL;AACD,mBARD,EASE,UAAA/F,GAAG;AAAA,2BAAI,MAAI,CAACpD,MAAL,CAAYiD,SAAZ,CAAsBG,GAAG,CAAC6B,OAA1B,CAAJ;AAAA,mBATL;AAWD;AACF;AACF,aAxBuB,CAAxB;AAyBD;AAjUkB;AAAA;AAAA,sCAmUP;AACV,gBAAI,2FAAyB,IAA7B,EAAmC;AACjC,kBAAImE,KAAK,GAAG,IAAIC,KAAJ,CAAU,4EAAV,CAAZ;AACAD,mBAAK,CAACE,IAAN;AACD;AACF;AAxUkB;;AAAA;AAAA,S;;;;gBAtBZ;;gBACA;;gBACA;;gBALA;;gBAMA;;gBAGA;;gBAFA;;gBALA;;gBAEoC;;gBAAgB;;gBAMpD;;gBACA;;gBACA;;gBARiB;;gBAUjB;;;;AAWIjK,cAAQ,6DALpB,gEAAU;AACTkK,gBAAQ,EAAE,UADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,0FAFS;;;;AAAA,OAAV,CAKoB,GAARnK,QAAQ,CAAR","file":"home-home-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"dark\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title>\\n      JetPort\\n    </ion-title>\\n  </ion-toolbar>\\n  <ion-item lines=\\\"none\\\">\\n    <ion-avatar slot=\\\"start\\\">\\n      <img src=\\\"{{ (driver)?.photoURL}}\\\" onerror=\\\"this.src='./assets/img/default.png'\\\">\\n    </ion-avatar>\\n    <ion-label>\\n      <h3 style=\\\"font-weight:500;\\\">{{ (driver)?.name }} - {{ (driver)?.rating }} <ion-icon name=\\\"star\\\"></ion-icon>\\n      </h3>\\n      <p>{{ (driver)?.brand }} • {{ (driver)?.model }} • {{ (driver)?.plate }} • {{ (driver)?.type }}</p>\\n    </ion-label>\\n    <ion-toggle (ionChange)=\\\"changeAvailability()\\\" [(ngModel)]=\\\"driver.isOnline\\\" [disabled]=\\\"!driver.isApproved\\\"\\n      slot=\\\"end\\\">\\n    </ion-toggle>\\n  </ion-item>\\n  <p style=\\\"margin:0; font-size: 12px;font-size: 12px;padding: 4px 8px;\\\">Localização: {{locality}}</p>\\n</ion-header>\\n\\n<ion-content>\\n  <p *ngIf=\\\"!driver.isApproved\\\" class=\\\"message\\\">Sua conta ainda não foi aprovada</p>\\n  <div id=\\\"map\\\" style=\\\"height: 100%;width:100%;\\\"></div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { HomePageRoutingModule } from './home-routing.module';\n\nimport { HomePage } from './home.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","export default \".welcome-card img {\\n  max-height: 35vh;\\n  overflow: hidden;\\n}\\n\\n.message {\\n  text-align: center;\\n  background: #FFC107;\\n  margin: 0;\\n  padding: 4px;\\n  font-size: 14px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaG9tZS9ob21lLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0VBQ0EsZ0JBQUE7QUFDSjs7QUFFRTtFQUNFLGtCQUFBO0VBQ0EsbUJBQUE7RUFDQSxTQUFBO0VBQ0EsWUFBQTtFQUNBLGVBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL2hvbWUvaG9tZS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIud2VsY29tZS1jYXJkIGltZyB7XG4gICAgbWF4LWhlaWdodDogMzV2aDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICB9XG4gIFxuICAubWVzc2FnZXtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgYmFja2dyb3VuZDogI0ZGQzEwNztcbiAgICBtYXJnaW46IDA7XG4gICAgcGFkZGluZzogNHB4O1xuICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgfVxuICBcbiAgXG4gIFxuICAiXX0= */\";","import { Component } from '@angular/core';\nimport { AUDIO_PATH, PLAY_AUDIO_ON_REQUEST, DEAL_TIMEOUT, POSITION_INTERVAL, DEAL_STATUS_PENDING, environment, TRIP_STATUS_WAITING, TRIP_STATUS_GOING } from 'src/environments/environment.prod';\nimport { AuthService } from '../services/auth.service';\n\nimport { Router } from '@angular/router';\nimport { DriverService } from '../services/driver.service';\nimport { AlertController, LoadingController, MenuController, Platform } from '@ionic/angular';\nimport { DealService } from '../services/deal.service';\nimport { PlaceService } from '../services/place.service';\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { CommonService } from '../services/common.service';\nimport { AndroidPermissions } from '@ionic-native/android-permissions/ngx';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { take } from 'rxjs/operators';\nimport { TripService } from '../services/trip.service';\n\n\ndeclare var google: any;\ndeclare var cordova;\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  map: any;\n  driver: any = {};\n  deal: any;\n  dealSubscription: any;\n  isDriverAvailable = false;\n  positionTracking: any;\n  dealStatus = false;\n  dealAlert: any;\n  position: any = [];\n  marker: any;\n  locality: any;\n\n  public job: any;\n  public remainingTime = DEAL_TIMEOUT;\n\n  constructor(\n    private driverService: DriverService,\n    private alertCtrl: AlertController,\n    private dealService: DealService,\n    private authService: AuthService,\n    private placeService: PlaceService,\n    private geolocation: Geolocation,\n    private translate: TranslateService,\n    private router: Router,\n    private menuCtrl: MenuController,\n    private platform: Platform,\n    private common: CommonService,\n    private permission: AndroidPermissions,\n    private afAuth: AngularFireAuth,\n    private loadCtrl: LoadingController,\n    private tripService: TripService,\n  ) {\n\n  }\n\n\n  loadMap(lat, lng) {\n    let latLng = new google.maps.LatLng(lat, lng);\n\n    let mapOptions: any = environment.mapOptions;\n    mapOptions.center = latLng;\n    mapOptions.mapTypeId = google.maps.MapTypeId.ROADMAP;\n\n    this.map = new google.maps.Map(document.getElementById('map'), mapOptions);\n\n    this.marker = new google.maps.Marker({\n      map: this.map,\n      animation: google.maps.Animation.DROP,\n      position: latLng,\n      icon: {\n        url: './assets/img/marker.png',\n        size: new google.maps.Size(32, 32),\n        origin: new google.maps.Point(0, 0),\n        anchor: new google.maps.Point(16, 16),\n        scaledSize: new google.maps.Size(32, 32)\n      },\n    });\n  }\n\n  changeAvailability() {\n    clearInterval(this.positionTracking);\n    console.log(this.driver.isOnline);\n\n    if (this.platform.is('mobile') && this.driver.isOnline == true) {\n      //console.log(\"entrei aqui incialmente\")\n      this.permission.checkPermission(this.permission.PERMISSION.ACCESS_FINE_LOCATION).then((res) => {\n        this.common.showToast(\"App Location Permission: \" + res.hasPermission);\n        if (!res.hasPermission) {\n          this.permission.requestPermission(this.permission.PERMISSION.ACCESS_FINE_LOCATION).then(res => {\n            console.log(res)\n          }).catch(err => {\n            console.log(err);\n          })\n        }\n      }).catch(err => {\n        console.log(err);\n      })\n\n    }\n\n    if (this.driver.isOnline == true) {\n\n      //this.common.showLoader();\n     // this.loadCtrl.create({ spinner: 'circles', id: 'location-access' }).then(l => l.present());\n\n      // get current location\n      this.geolocation.getCurrentPosition({\n        enableHighAccuracy: true,\n        timeout: 10000\n      }).then((resp) => {\n        //console.log('chegamos aqui no PC', resp)\n        //this.loadCtrl.dismiss();\n\n        this.driverService.getDriver(this.driver.uid).update({ isOnline: true });\n        //Enabling background mode if app is running on device\n\n        this.position = [resp.coords.latitude, resp.coords.longitude];\n        console.log('position', this.position);\n\n        let latLng = new google.maps.LatLng(resp.coords.latitude, resp.coords.longitude);\n        let geocoder = new google.maps.Geocoder();\n\n        this.loadMap(resp.coords.latitude, resp.coords.longitude);\n        // find address from lat lng\n        geocoder.geocode({ 'latLng': latLng }, (results, status) => {\n          if (status == google.maps.GeocoderStatus.OK) {\n            //console.log(\"Resultado da posiçao\", results);\n            // save locality\n            this.locality = this.placeService.setLocalityFromGeocoder(results);\n           // console.log('locality', this.locality);\n\n            // start tracking\n            this.positionTracking = setInterval(() => {\n              //console.log(\"Tecnico Online\", this.driver.type)\n              // check for driver object, if it did not complete profile, stop updating location\n              if (!this.driver || !this.driver.type) return;\n\n\n              if (this.driver.isOnline ) {\n                // Periodic update after particular time intrvel\n                this.geolocation.getCurrentPosition({\n                  enableHighAccuracy: true,\n                  timeout: 10000\n                }).then((resp) => {\n                  console.log(resp);\n                  this.driverService.updatePosition(this.driver.uid, this.driver.type, this.locality, resp.coords.latitude, resp.coords.longitude, this.driver.rating, this.driver.name);\n\n\n                  let location = new google.maps.LatLng(resp.coords.latitude, resp.coords.longitude)\n\n                  this.marker.setPosition(location);\n                  this.map.setCenter(location);\n\n                }, err => {\n                  this.common.showToast(err.message);\n                  console.log(err);\n                });\n\n              }\n\n            }, POSITION_INTERVAL);\n\n\n            this.watchDeals();\n          }\n        });\n      }, (err) => {\n        console.log(err);\n        this.loadCtrl.dismiss();\n        this.common.showToast(\"Something went wrong while accessing your location. Please make sure, you have GPS access on device\");\n        this.driver.isOnline = false;\n        this.driverService.getDriver(this.driver.uid).update({ isOnline: false });\n      });\n\n    }\n    else {\n      clearInterval(this.positionTracking);\n      this.driverService.getDriver(this.driver.uid).update({ isOnline: false });\n      this.driverService.remove(this.driver.uid, this.driver.type, this.locality);\n      if (this.dealSubscription) this.dealSubscription.unsubscribe();\n      this.common.showToast(\"Você está Offline agora\");\n    }\n\n  }\n\n  // count down\n  countDown() {\n    let interval = setInterval(() => {\n      this.remainingTime--;\n      this.dealAlert.subHeader = 'Fechamento em ' + this.remainingTime + ' sec';\n      if (this.remainingTime == 0) {\n        clearInterval(interval);\n        this.cancelDeal();\n        this.remainingTime = DEAL_TIMEOUT;\n      }\n    }, 1000);\n    this.confirmJob();\n  }\n\n  cancelDeal() {\n    console.log(\"close\")\n    this.dealStatus = false;\n    this.dealAlert.dismiss();\n    this.dealService.removeDeal(this.driver.uid);\n  }\n\n  ionViewDidEnter() {\n    this.menuCtrl.enable(true);\n\n    this.afAuth.onAuthStateChanged((user) => {\n      console.log('user', user)\n      if (user != null) {\n        this.driverService.getDriver(user.uid).valueChanges().subscribe((snapshot: any) => {\n         // console.log(\"dados recebidos do tecnico\",snapshot);\n          if (snapshot != null) {\n            this.driver = snapshot;\n            if (this.driver.isOnline && this.platform.is('mobile')) {\n\n              //enable background location update when app minimized\n\n              this.platform.pause.pipe(take(1)).subscribe(() => {\n                if (this.driver.isOnline) {\n                  console.log(\"App minimized\");\n                  cordova.plugins.backgroundMode.setDefaults({ id: -1, title: 'Aplicativo do Técnico', text: 'Background', hidden: false, silent: false });\n\n                  cordova.plugins.backgroundMode.setEnabled(true);\n                  cordova.plugins.backgroundMode.on('enable', () => {\n                    console.log('background mode Enabled !!!');\n\n                    cordova.plugins.backgroundMode.disableWebViewOptimizations();\n                    cordova.plugins.backgroundMode.disableBatteryOptimizations();\n                  });\n                }\n              })\n\n              cordova.plugins.backgroundMode.on('active', () => console.log(\"bgm: active\"))\n\n              cordova.plugins.backgroundMode.on('deactivate', () => console.log(\"bgm: deactive\"))\n\n              cordova.plugins.backgroundMode.on('failure', () => console.log(\"bgm: failed\"))\n\n              cordova.plugins.backgroundMode.on('disable', () => {\n                console.log('bgm: disable')\n              });\n\n\n              //disabling background mode when app resume;\n              this.platform.resume.pipe(take(1)).subscribe(() => cordova.plugins.backgroundMode.setEnabled(false));\n            }\n          }\n        });\n\n        this.tripService.getLastTrips(user.uid).valueChanges().pipe(take(1)).subscribe((trips: any) => {\n          trips.forEach(trip => {\n            if (trip.status == TRIP_STATUS_WAITING || trip.status == TRIP_STATUS_GOING) {\n              this.tripService.setCurrentTrip(trip.key);\n              this.router.navigateByUrl('/pickup');\n            }\n          });\n        })\n\n      }\n    });\n\n\n\n  }\n\n  range(n) {\n    return new Array(Math.round(n));\n  }\n\n  // confirm a job\n  confirmJob() {\n    //console.log(\"confirm\");\n    let message = \"<b>Local:</b> (\" + this.job.origin.distance + \"km)<br/>\" + this.job.origin.vicinity \n    //+ \"<br/><b>To:</b>(\" + this.job.destination.distance + \"km)<br>\" + this.job.destination.vicinity + \"<br> <p>Your Commission: <h5>\" + this.job.currency + this.job.commission + \"</h5></p>\";\n\n    this.alertCtrl.create({\n      id: this.job.key,\n      header: 'Nova Solicitação',\n      message: message,\n      cssClass: 'customAlert',\n      buttons: [\n        {\n          text: 'Rejeitar',\n          role: 'cancel',\n          handler: () => {\n          //  console.log('Disagree clicked');\n            this.dealStatus = false;\n            this.dealService.removeDeal(this.driver.uid);\n          }\n        },\n        {\n          text: 'Aceitar',\n          handler: () => {\n            this.dealStatus = false;\n            this.dealService.acceptDeal(this.driver.uid, this.deal).then(() => {\n              this.router.navigateByUrl('pickup');\n            });\n          }\n        }\n      ]\n    }).then(res => {\n      this.dealAlert = res;\n      this.dealAlert.present();\n    });\n\n    this.playAudio();\n  }\n\n\n  // listen to deals\n  watchDeals() {\n    // listen to deals\n    this.dealSubscription = this.dealService.getDeal(this.driver.uid).valueChanges().subscribe((snapshot: any) => {\n      if (snapshot != null || snapshot != undefined) {\n        this.deal = snapshot;\n        if (snapshot.status == DEAL_STATUS_PENDING) {\n          // if deal expired\n          if (snapshot.createdAt < (Date.now() - DEAL_TIMEOUT * 1000)) {\n            return this.dealService.removeDeal(this.driver.uid);\n          }\n          this.dealStatus = true;\n          this.job = snapshot;\n\n          this.geolocation.getCurrentPosition({\n            enableHighAccuracy: true,\n            timeout: 10000\n          }).then((resp) => {\n            //resp.coords.longitude\n            this.job.origin.distance = this.placeService.calcCrow(resp.coords.latitude, resp.coords.longitude, this.job.origin.location.lat, this.job.origin.location.lng).toFixed(0);\n            this.job.destination.distance = this.placeService.calcCrow(resp.coords.latitude, resp.coords.longitude, this.job.destination.location.lat, this.job.destination.location.lng).toFixed(0);\n            this.countDown();\n          },\n            err => this.common.showToast(err.message)\n          );\n        }\n      }\n    });\n  }\n\n  playAudio() {\n    if (PLAY_AUDIO_ON_REQUEST == true) {\n      let audio = new Audio(AUDIO_PATH);\n      audio.play();\n    }\n  }\n}\n"]}